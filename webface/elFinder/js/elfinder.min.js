/*!
 * elFinder - file manager for web
 * Version 2.0.2
 * http://elfinder.org
 * 
 * Copyright 2009-2012, Studio 42
 * Licensed under a 3 clauses BSD license
 */
(function(a){window.elFinder=function(C,s){this.time("load");var w=this,C=a(C),l=a("<div/>").append(C.contents()),F=C.attr("style"),x=C.attr("id")||"",q="elfinder-"+(x||Math.random().toString().substr(2,7)),E="mousedown."+q,u="keydown."+q,n="keypress."+q,k=true,d=true,b=["enable","disable","load","open","reload","select","add","remove","change","dblclick","getfile","lockfiles","unlockfiles","dragstart","dragstop"],m={},e="",I={path:"",url:"",tmbUrl:"",disabled:[],separator:"/",archives:[],extract:[],copyOverwrite:true,tmb:false},h={},A=[],z={},y={},i=[],p=[],D=[],g=new w.command(w),B="auto",v=400,f=a(document.createElement("audio")).hide().appendTo("body")[0],G,r=function(K){if(K.init){h={}}else{for(var J in h){if(h.hasOwnProperty(J)&&h[J].mime!="directory"&&h[J].phash==e&&a.inArray(J,p)===-1){delete h[J]}}}e=K.cwd.hash;t(K.files);if(!h[e]){t([K.cwd])}w.lastDir(e)},t=function(N){var J=N.length,M;while(J--){M=N[J];if(M.name&&M.hash&&M.mime){if(!M.phash){var K="volume_"+M.name,L=w.i18n(K);if(K!=L){M.i18=L}}h[M.hash]=M}}},j=function(K){var J=K.keyCode,L=!!(K.ctrlKey||K.metaKey);if(k){a.each(y,function(N,M){if(M.type==K.type&&M.keyCode==J&&M.shiftKey==K.shiftKey&&M.ctrlKey==L&&M.altKey==K.altKey){K.preventDefault();K.stopPropagation();M.callback(K,w);w.debug("shortcut-exec",N+" : "+M.description)}});if(J==9&&!a(K.target).is(":input")){K.preventDefault()}}},H=new Date(),c,o;this.api=null;this.newAPI=false;this.oldAPI=false;this.OS=navigator.userAgent.indexOf("Mac")!==-1?"mac":navigator.userAgent.indexOf("Win")!==-1?"win":"other";this.UA=(function(){var J=!document.uniqueID&&!window.opera&&!window.sidebar&&window.localStorage&&typeof window.orientation=="undefined";return{ltIE6:typeof window.addEventListener=="undefined"&&typeof document.documentElement.style.maxHeight=="undefined",ltIE7:typeof window.addEventListener=="undefined"&&typeof document.querySelectorAll=="undefined",ltIE8:typeof window.addEventListener=="undefined"&&typeof document.getElementsByClassName=="undefined",IE:document.uniqueID,Firefox:window.sidebar,Opera:window.opera,Webkit:J,Chrome:J&&window.chrome,Safari:J&&!window.chrome,Mobile:typeof window.orientation!="undefined"}})();this.options=a.extend(true,{},this._options,s||{});if(s.ui){this.options.ui=s.ui}if(s.commands){this.options.commands=s.commands}if(s.uiOptions&&s.uiOptions.toolbar){this.options.uiOptions.toolbar=s.uiOptions.toolbar}a.extend(this.options.contextmenu,s.contextmenu);this.requestType=/^(get|post)$/i.test(this.options.requestType)?this.options.requestType.toLowerCase():"get",this.customData=a.isPlainObject(this.options.customData)?this.options.customData:{};this.id=x;this.uploadURL=s.urlUpload||s.url;this.namespace=q;this.lang=this.i18[this.options.lang]&&this.i18[this.options.lang].messages?this.options.lang:"en";o=this.lang=="en"?this.i18.en:a.extend(true,{},this.i18.en,this.i18[this.lang]);this.direction=o.direction;this.messages=o.messages;this.dateFormat=this.options.dateFormat||o.dateFormat;this.fancyFormat=this.options.fancyDateFormat||o.fancyDateFormat;this.today=(new Date(H.getFullYear(),H.getMonth(),H.getDate())).getTime()/1000;this.yesterday=this.today-86400;c=this.options.UTCDate?"UTC":"";this.getHours="get"+c+"Hours";this.getMinutes="get"+c+"Minutes";this.getSeconds="get"+c+"Seconds";this.getDate="get"+c+"Date";this.getDay="get"+c+"Day";this.getMonth="get"+c+"Month";this.getFullYear="get"+c+"FullYear";this.cssClass="ui-helper-reset ui-helper-clearfix ui-widget ui-widget-content ui-corner-all elfinder elfinder-"+(this.direction=="rtl"?"rtl":"ltr")+" "+this.options.cssClass;this.storage=(function(){try{return"localStorage" in window&&window.localStorage!==null?w.localStorage:w.cookie}catch(J){return w.cookie}})();this.viewType=this.storage("view")||this.options.defaultView||"icons";this.sortType=this.storage("sortType")||this.options.sortType||"name";this.sortOrder=this.storage("sortOrder")||this.options.sortOrder||"asc";this.sortStickFolders=this.storage("sortStickFolders");if(this.sortStickFolders===null){this.sortStickFolders=!!this.options.sortStickFolders}else{this.sortStickFolders=!!this.sortStickFolders}this.sortRules=a.extend(true,{},this._sortRules,this.options.sortsRules);a.each(this.sortRules,function(J,K){if(typeof K!="function"){delete w.sortRules[J]}});this.compare=a.proxy(this.compare,this);this.notifyDelay=this.options.notifyDelay>0?parseInt(this.options.notifyDelay):500;this.draggable={appendTo:"body",addClasses:true,delay:30,revert:true,refreshPositions:true,cursor:"move",cursorAt:{left:50,top:47},drag:function(K,J){if(!J.helper.data("locked")){J.helper.toggleClass("elfinder-drag-helper-plus",K.shiftKey||K.ctrlKey||K.metaKey)}},start:function(N,M){var J=a.map(M.helper.data("files")||[],function(O){return O||null}),K,L;K=J.length;while(K--){L=J[K];if(h[L].locked){M.helper.addClass("elfinder-drag-helper-plus").data("locked",true);break}}},stop:function(){w.trigger("focus").trigger("dragstop")},helper:function(P,O){var L=this.id?a(this):a(this).parents("[id]:first"),N=a('<div class="elfinder-drag-helper"><span class="elfinder-drag-helper-icon-plus"/></div>'),M=function(Q){return'<div class="elfinder-cwd-icon '+w.mime2class(Q)+' ui-corner-all"/>'},K,J;w.trigger("dragstart",{target:L[0],originalEvent:P});K=L.is("."+w.res("class","cwdfile"))?w.selected():[w.navId2Hash(L.attr("id"))];N.append(M(h[K[0]].mime)).data("files",K).data("locked",false);if((J=K.length)>1){N.append(M(h[K[J-1]].mime)+'<span class="elfinder-drag-num">'+J+"</span>")}return N}};this.droppable={tolerance:"pointer",accept:".elfinder-cwd-file-wrapper,.elfinder-navbar-dir,.elfinder-cwd-file",hoverClass:this.res("class","adroppable"),drop:function(O,R){var P=a(this),N=a.map(R.helper.data("files")||[],function(T){return T||null}),S=[],Q="class",J,L,K,M;if(P.is("."+w.res(Q,"cwd"))){L=e}else{if(P.is("."+w.res(Q,"cwdfile"))){L=P.attr("id")}else{if(P.is("."+w.res(Q,"navdir"))){L=w.navId2Hash(P.attr("id"))}}}J=N.length;while(J--){M=N[J];M!=L&&h[M].phash!=L&&S.push(M)}if(S.length){R.helper.hide();w.clipboard(S,!(O.ctrlKey||O.shiftKey||O.metaKey||R.helper.data("locked")));w.exec("paste",L);w.trigger("drop",{files:N})}}};this.enabled=function(){return C.is(":visible")&&k};this.visible=function(){return C.is(":visible")};this.root=function(L){var J=h[L||e],K;while(J&&J.phash){J=h[J.phash]}if(J){return J.hash}while(K in h&&h.hasOwnProperty(K)){J=h[K];if(!J.phash&&!J.mime=="directory"&&J.read){return J.hash}}return""};this.cwd=function(){return h[e]||{}};this.option=function(J){return I[J]||""};this.file=function(J){return h[J]};this.files=function(){return a.extend(true,{},h)};this.parents=function(L){var K=[],J;while((J=this.file(L))){K.unshift(J.hash);L=J.phash}return K};this.path2array=function(M,K){var J,L=[];while(M&&(J=h[M])&&J.hash){L.unshift(K&&J.i18?J.i18:J.name);M=J.phash}return L};this.path=function(K,J){return h[K]&&h[K].path?h[K].path:this.path2array(K,J).join(I.separator)};this.url=function(K){var J=h[K];if(!J||!J.read){return""}if(J.url){return J.url}if(I.url){return I.url+a.map(this.path2array(K),function(M){return encodeURIComponent(M)}).slice(1).join("/")}var L=a.extend({},this.customData,{cmd:"file",target:J.hash});if(this.oldAPI){L.cmd="open";L.current=J.phash}return this.options.url+(this.options.url.indexOf("?")===-1?"?":"&")+a.param(L,true)};this.tmb=function(L){var K=h[L],J=K&&K.tmb&&K.tmb!=1?I.tmbUrl+K.tmb:"";if(J&&(this.UA.Opera||this.UA.IE)){J+="?_="+new Date().getTime()}return J};this.selected=function(){return A.slice(0)};this.selectedFiles=function(){return a.map(A,function(J){return h[J]?a.extend({},h[J]):null})};this.fileByName=function(J,L){var K;for(K in h){if(h.hasOwnProperty(K)&&h[K].phash==L&&h[K].name==J){return h[K]}}};this.validResponse=function(K,J){return J.error||this.rules[this.rules[K]?K:"defaults"](J)};this.request=function(Z){var Y=this,L=this.options,J=a.Deferred(),O=a.extend({},L.customData,{mimes:L.onlyMimes},Z.data||Z),M=O.cmd,P=!(Z.preventDefault||Z.preventFail),S=!(Z.preventDefault||Z.preventDone),W=a.extend({},Z.notify),U=!!Z.raw,R=Z.syncOnFail,T,Z=a.extend({url:L.url,async:true,type:this.requestType,dataType:"json",cache:false,data:O},Z.options||{}),N=function(aa){aa.warning&&Y.error(aa.warning);M=="open"&&r(a.extend(true,{},aa));aa.removed&&aa.removed.length&&Y.remove(aa);aa.added&&aa.added.length&&Y.add(aa);aa.changed&&aa.changed.length&&Y.change(aa);Y.trigger(M,aa);aa.sync&&Y.sync()},Q=function(ac,aa){var ab;switch(aa){case"abort":ab=ac.quiet?"":["errConnect","errAbort"];break;case"timeout":ab=["errConnect","errTimeout"];break;case"parsererror":ab=["errResponse","errDataNotJSON"];break;default:if(ac.status==403){ab=["errConnect","errAccess"]}else{if(ac.status==404){ab=["errConnect","errNotFound"]}else{ab="errConnect"}}}J.reject(ab,ac,aa)},V=function(aa){if(U){return J.resolve(aa)}if(!aa){return J.reject(["errResponse","errDataEmpty"],X)}else{if(!a.isPlainObject(aa)){return J.reject(["errResponse","errDataNotJSON"],X)}else{if(aa.error){return J.reject(aa.error,X)}else{if(!Y.validResponse(M,aa)){return J.reject("errResponse",X)}}}}aa=Y.normalize(aa);if(!Y.api){Y.api=aa.api||1;Y.newAPI=Y.api>=2;Y.oldAPI=!Y.newAPI}if(aa.options){I=a.extend({},I,aa.options)}if(aa.netDrivers){Y.netDrivers=aa.netDrivers}J.resolve(aa);aa.debug&&Y.debug("backend-debug",aa.debug)},X,K;S&&J.done(N);J.fail(function(aa){if(aa){P?Y.error(aa):Y.debug("error",Y.i18n(aa))}});if(!M){return J.reject("errCmdReq")}if(R){J.fail(function(aa){aa&&Y.sync()})}if(W.type&&W.cnt){T=setTimeout(function(){Y.notify(W);J.always(function(){W.cnt=-(parseInt(W.cnt)||0);Y.notify(W)})},Y.notifyDelay);J.always(function(){clearTimeout(T)})}if(M=="open"){while((K=D.pop())){if(K.state()=="pending"){K.quiet=true;K.abort()}}}delete Z.preventFail;X=this.transport.send(Z).fail(Q).done(V);if(M=="open"){D.unshift(X);J.always(function(){var aa=a.inArray(X,D);aa!==-1&&D.splice(aa,1)})}return J};this.diff=function(J){var L={},M=[],N=[],O=[],K=function(Q){var P=O.length;while(P--){if(O[P].hash==Q){return true}}};a.each(J,function(P,Q){L[Q.hash]=Q});a.each(h,function(Q,P){!L[Q]&&N.push(Q)});a.each(L,function(R,Q){var P=h[R];if(!P){M.push(Q)}else{a.each(Q,function(S){if(Q[S]!=P[S]){O.push(Q);return false}})}});a.each(N,function(Q,R){var P=h[R],S=P.phash;if(S&&P.mime=="directory"&&a.inArray(S,N)===-1&&L[S]&&!K(S)){O.push(L[S])}});return{added:M,removed:N,changed:O}};this.sync=function(){var M=this,L=a.Deferred().done(function(){M.trigger("sync")}),K={data:{cmd:"open",init:1,target:e,tree:this.ui.tree?1:0},preventDefault:true},J={data:{cmd:"tree",target:(e==this.root())?e:this.file(e).phash},preventDefault:true};a.when(this.request(K),this.request(J)).fail(function(N){L.reject(N);N&&M.request({data:{cmd:"open",target:M.lastDir(""),tree:1,init:1},notify:{type:"open",cnt:1,hideCnt:true},preventDefault:true})}).done(function(N,P){var O=M.diff(N.files.concat(P&&P.tree?P.tree:[]));O.added.push(N.cwd);O.removed.length&&M.remove(O);O.added.length&&M.add(O);O.changed.length&&M.change(O);return L.resolve(O)});return L};this.upload=function(J){return this.transport.upload(J,this)};this.bind=function(K,L){var J;if(typeof(L)=="function"){K=(""+K).toLowerCase().split(/\s+/);for(J=0;J<K.length;J++){if(z[K[J]]===void (0)){z[K[J]]=[]}z[K[J]].push(L)}}return this};this.unbind=function(L,M){var J=z[(""+L).toLowerCase()]||[],K=J.indexOf(M);K>-1&&J.splice(K,1);M=null;return this};this.trigger=function(N,O){var N=N.toLowerCase(),J=z[N]||[],M,K;this.debug("event-"+N,O);if(J.length){N=a.Event(N);for(M=0;M<J.length;M++){N.data=a.extend(true,{},O);try{if(J[M](N,this)===false||N.isDefaultPrevented()){this.debug("event-stoped",N.type);break}}catch(L){window.console&&window.console.log&&window.console.log(L)}}}return this};this.shortcut=function(L){var K,N,M,J,O;if(this.options.allowShortcuts&&L.pattern&&a.isFunction(L.callback)){K=L.pattern.toUpperCase().split(/\s+/);for(J=0;J<K.length;J++){N=K[J];O=N.split("+");M=(M=O.pop()).length==1?M>0?M:M.charCodeAt(0):a.ui.keyCode[M];if(M&&!y[N]){y[N]={keyCode:M,altKey:a.inArray("ALT",O)!=-1,ctrlKey:a.inArray("CTRL",O)!=-1,shiftKey:a.inArray("SHIFT",O)!=-1,type:L.type||"keydown",callback:L.callback,description:L.description,pattern:N}}}}return this};this.shortcuts=function(){var J=[];a.each(y,function(K,L){J.push([L.pattern,w.i18n(L.description)])});return J};this.clipboard=function(J,K){var L=function(){return a.map(i,function(M){return M.hash})};if(J!==void (0)){i.length&&this.trigger("unlockfiles",{files:L()});p=[];i=a.map(J||[],function(N){var M=h[N];if(M){p.push(N);return{hash:N,phash:M.phash,name:M.name,mime:M.mime,read:M.read,locked:M.locked,cut:!!K}}return null});this.trigger("changeclipboard",{clipboard:i.slice(0,i.length)});K&&this.trigger("lockfiles",{files:L()})}return i.slice(0,i.length)};this.isCommandEnabled=function(J){return this._commands[J]?a.inArray(J,I.disabled)===-1:false};this.exec=function(L,K,J){return this._commands[L]&&this.isCommandEnabled(L)?this._commands[L].exec(K,J):a.Deferred().reject("No such command")};this.dialog=function(K,J){return a("<div/>").append(K).appendTo(C).elfinderdialog(J)};this.getUI=function(J){return this.ui[J]||C};this.command=function(J){return J===void (0)?this._commands:this._commands[J]};this.resize=function(J,K){C.css("width",J).height(K).trigger("resize");this.trigger("resize",{width:C.width(),height:C.height()})};this.restoreSize=function(){this.resize(B,v)};this.show=function(){C.show();this.enable().trigger("show")};this.hide=function(){this.disable().trigger("hide");C.hide()};this.destroy=function(){if(C&&C[0].elfinder){this.trigger("destroy").disable();z={};y={};a(document).add(C).unbind("."+this.namespace);w.trigger=function(){};C.children().remove();C.append(l.contents()).removeClass(this.cssClass).attr("style",F);C[0].elfinder=null;if(G){clearInterval(G)}}};if(!(a.fn.selectable&&a.fn.draggable&&a.fn.droppable)){return alert(this.i18n("errJqui"))}if(!C.length){return alert(this.i18n("errNode"))}if(!this.options.url){return alert(this.i18n("errURL"))}a.extend(a.ui.keyCode,{F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120});this.dragUpload=false;this.xhrUpload=typeof XMLHttpRequestUpload!="undefined"&&typeof File!="undefined"&&typeof FormData!="undefined";this.transport={};if(typeof(this.options.transport)=="object"){this.transport=this.options.transport;if(typeof(this.transport.init)=="function"){this.transport.init(this)}}if(typeof(this.transport.send)!="function"){this.transport.send=function(J){return a.ajax(J)}}if(this.transport.upload=="iframe"){this.transport.upload=a.proxy(this.uploads.iframe,this)}else{if(typeof(this.transport.upload)=="function"){this.dragUpload=!!this.options.dragUploadAllow}else{if(this.xhrUpload){this.transport.upload=a.proxy(this.uploads.xhr,this);this.dragUpload=true}else{this.transport.upload=a.proxy(this.uploads.iframe,this)}}}this.error=function(){var J=arguments[0];return arguments.length==1&&typeof(J)=="function"?w.bind("error",J):w.trigger("error",{error:J})};a.each(["enable","disable","load","open","reload","select","add","remove","change","dblclick","getfile","lockfiles","unlockfiles","dragstart","dragstop","search","searchend","viewchange"],function(K,J){w[J]=function(){var L=arguments[0];return arguments.length==1&&typeof(L)=="function"?w.bind(J,L):w.trigger(J,a.isPlainObject(L)?L:{})}});this.enable(function(){if(!k&&w.visible()&&w.ui.overlay.is(":hidden")){k=true;a("texarea:focus,input:focus,button").blur();C.removeClass("elfinder-disabled")}}).disable(function(){d=k;k=false;C.addClass("elfinder-disabled")}).open(function(){A=[]}).select(function(J){A=a.map(J.data.selected||J.data.value||[],function(K){return h[K]?K:null})}).error(function(K){var J={cssClass:"elfinder-dialog-error",title:w.i18n(w.i18n("error")),resizable:false,destroyOnClose:true,buttons:{}};J.buttons[w.i18n(w.i18n("btnClose"))]=function(){a(this).elfinderdialog("close")};w.dialog('<span class="elfinder-dialog-icon elfinder-dialog-icon-error"/>'+w.i18n(K.data.error),J)}).bind("tree parents",function(J){t(J.data.tree||[])}).bind("tmb",function(J){a.each(J.data.images||[],function(L,K){if(h[L]){h[L].tmb=K}})}).add(function(J){t(J.data.added||[])}).change(function(J){a.each(J.data.changed||[],function(L,K){var M=K.hash;h[M]=h[M]?a.extend(h[M],K):K})}).remove(function(M){var L=M.data.removed||[],J=L.length,K=function(O){var N=h[O];if(N){if(N.mime=="directory"&&N.dirs){a.each(h,function(P,Q){Q.phash==O&&K(P)})}delete h[O]}};while(J--){K(L[J])}}).bind("search",function(J){t(J.data.files)}).bind("rm",function(K){var J=f.canPlayType&&f.canPlayType('audio/wav; codecs="1"');J&&J!=""&&J!="no"&&a(f).html('<source src="./sounds/rm.wav" type="audio/wav">')[0].play()});a.each(this.options.handlers,function(J,K){w.bind(J,K)});this.history=new this.history(this);if(typeof(this.options.getFileCallback)=="function"&&this.commands.getfile){this.bind("dblclick",function(J){J.preventDefault();w.exec("getfile").fail(function(){w.exec("open")})});this.shortcut({pattern:"enter",description:this.i18n("cmdgetfile"),callback:function(){w.exec("getfile").fail(function(){w.exec(w.OS=="mac"?"rename":"open")})}}).shortcut({pattern:"ctrl+enter",description:this.i18n(this.OS=="mac"?"cmdrename":"cmdopen"),callback:function(){w.exec(w.OS=="mac"?"rename":"open")}})}this._commands={};if(!a.isArray(this.options.commands)){this.options.commands=[]}a.each(["open","reload","back","forward","up","home","info","quicklook","getfile","help"],function(J,K){a.inArray(K,w.options.commands)===-1&&w.options.commands.push(K)});a.each(this.options.commands,function(K,J){var L=w.commands[J];if(a.isFunction(L)&&!w._commands[J]){L.prototype=g;w._commands[J]=new L();w._commands[J].setup(J,w.options.commandsOptions[J]||{})}});C.addClass(this.cssClass).bind(E,function(){!k&&w.enable()});this.ui={workzone:a("<div/>").appendTo(C).elfinderworkzone(this),navbar:a("<div/>").appendTo(C).elfindernavbar(this,this.options.uiOptions.navbar||{}),contextmenu:a("<div/>").appendTo(C).elfindercontextmenu(this),overlay:a("<div/>").appendTo(C).elfinderoverlay({show:function(){w.disable()},hide:function(){d&&w.enable()}}),cwd:a("<div/>").appendTo(C).elfindercwd(this,this.options.uiOptions.cwd||{}),notify:this.dialog("",{cssClass:"elfinder-dialog-notify",position:{top:"12px",right:"12px"},resizable:false,autoOpen:false,title:"&nbsp;",width:280}),statusbar:a('<div class="ui-widget-header ui-helper-clearfix ui-corner-bottom elfinder-statusbar"/>').hide().appendTo(C)};a.each(this.options.ui||[],function(K,M){var J="elfinder"+M,L=w.options.uiOptions[M]||{};if(!w.ui[M]&&a.fn[J]){w.ui[M]=a("<"+(L.tag||"div")+"/>").appendTo(C)[J](w,L)}});C[0].elfinder=this;this.options.resizable&&a.fn.resizable&&C.resizable({handles:"se",minWidth:300,minHeight:200});if(this.options.width){B=this.options.width}if(this.options.height){v=parseInt(this.options.height)}w.resize(B,v);a(document).bind("click."+this.namespace,function(J){k&&!a(J.target).closest(C).length&&w.disable()}).bind(u+" "+n,j);this.trigger("init").request({data:{cmd:"open",target:w.lastDir(),init:1,tree:this.ui.tree?1:0},preventDone:true,notify:{type:"open",cnt:1,hideCnt:true},freeze:true}).fail(function(){w.trigger("fail").disable().lastDir("");z={};y={};a(document).add(C).unbind("."+this.namespace);w.trigger=function(){}}).done(function(J){w.load().debug("api",w.api);J=a.extend(true,{},J);r(J);w.trigger("open",J)});this.one("load",function(){C.trigger("resize");if(w.options.sync>1000){G=setInterval(function(){w.sync()},w.options.sync)}})};elFinder.prototype={res:function(b,c){return this.resources[b]&&this.resources[b][c]},i18:{en:{translator:"",language:"English",direction:"ltr",dateFormat:"d.m.Y H:i",fancyDateFormat:"$1 H:i",messages:{}},months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},kinds:{unknown:"Unknown",directory:"Folder",symlink:"Alias","symlink-broken":"AliasBroken","application/x-empty":"TextPlain","application/postscript":"Postscript","application/vnd.ms-office":"MsOffice","application/vnd.ms-word":"MsWord","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"MsWord","application/vnd.ms-word.document.macroEnabled.12":"MsWord","application/vnd.openxmlformats-officedocument.wordprocessingml.template":"MsWord","application/vnd.ms-word.template.macroEnabled.12":"MsWord","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"MsWord","application/vnd.ms-excel":"MsExcel","application/vnd.ms-excel.sheet.macroEnabled.12":"MsExcel","application/vnd.openxmlformats-officedocument.spreadsheetml.template":"MsExcel","application/vnd.ms-excel.template.macroEnabled.12":"MsExcel","application/vnd.ms-excel.sheet.binary.macroEnabled.12":"MsExcel","application/vnd.ms-excel.addin.macroEnabled.12":"MsExcel","application/vnd.ms-powerpoint":"MsPP","application/vnd.openxmlformats-officedocument.presentationml.presentation":"MsPP","application/vnd.ms-powerpoint.presentation.macroEnabled.12":"MsPP","application/vnd.openxmlformats-officedocument.presentationml.slideshow":"MsPP","application/vnd.ms-powerpoint.slideshow.macroEnabled.12":"MsPP","application/vnd.openxmlformats-officedocument.presentationml.template":"MsPP","application/vnd.ms-powerpoint.template.macroEnabled.12":"MsPP","application/vnd.ms-powerpoint.addin.macroEnabled.12":"MsPP","application/vnd.openxmlformats-officedocument.presentationml.slide":"MsPP","application/vnd.ms-powerpoint.slide.macroEnabled.12":"MsPP","application/pdf":"PDF","application/xml":"XML","application/vnd.oasis.opendocument.text":"OO","application/vnd.oasis.opendocument.text-template":"OO","application/vnd.oasis.opendocument.text-web":"OO","application/vnd.oasis.opendocument.text-master":"OO","application/vnd.oasis.opendocument.graphics":"OO","application/vnd.oasis.opendocument.graphics-template":"OO","application/vnd.oasis.opendocument.presentation":"OO","application/vnd.oasis.opendocument.presentation-template":"OO","application/vnd.oasis.opendocument.spreadsheet":"OO","application/vnd.oasis.opendocument.spreadsheet-template":"OO","application/vnd.oasis.opendocument.chart":"OO","application/vnd.oasis.opendocument.formula":"OO","application/vnd.oasis.opendocument.database":"OO","application/vnd.oasis.opendocument.image":"OO","application/vnd.openofficeorg.extension":"OO","application/x-shockwave-flash":"AppFlash","application/flash-video":"Flash video","application/x-bittorrent":"Torrent","application/javascript":"JS","application/rtf":"RTF","application/rtfd":"RTF","application/x-font-ttf":"TTF","application/x-font-otf":"OTF","application/x-rpm":"RPM","application/x-web-config":"TextPlain","application/xhtml+xml":"HTML","application/docbook+xml":"DOCBOOK","application/x-awk":"AWK","application/x-gzip":"GZIP","application/x-bzip2":"BZIP","application/zip":"ZIP","application/x-zip":"ZIP","application/x-rar":"RAR","application/x-tar":"TAR","application/x-7z-compressed":"7z","application/x-jar":"JAR","text/plain":"TextPlain","text/x-php":"PHP","text/html":"HTML","text/javascript":"JS","text/css":"CSS","text/rtf":"RTF","text/rtfd":"RTF","text/x-c":"C","text/x-csrc":"C","text/x-chdr":"CHeader","text/x-c++":"CPP","text/x-c++src":"CPP","text/x-c++hdr":"CPPHeader","text/x-shellscript":"Shell","application/x-csh":"Shell","text/x-python":"Python","text/x-java":"Java","text/x-java-source":"Java","text/x-ruby":"Ruby","text/x-perl":"Perl","text/x-sql":"SQL","text/xml":"XML","text/x-comma-separated-values":"CSV","image/x-ms-bmp":"BMP","image/jpeg":"JPEG","image/gif":"GIF","image/png":"PNG","image/tiff":"TIFF","image/x-targa":"TGA","image/vnd.adobe.photoshop":"PSD","image/xbm":"XBITMAP","image/pxm":"PXM","audio/mpeg":"AudioMPEG","audio/midi":"AudioMIDI","audio/ogg":"AudioOGG","audio/mp4":"AudioMPEG4","audio/x-m4a":"AudioMPEG4","audio/wav":"AudioWAV","audio/x-mp3-playlist":"AudioPlaylist","video/x-dv":"VideoDV","video/mp4":"VideoMPEG4","video/mpeg":"VideoMPEG","video/x-msvideo":"VideoAVI","video/quicktime":"VideoMOV","video/x-ms-wmv":"VideoWM","video/x-flv":"VideoFlash","video/x-matroska":"VideoMKV","video/ogg":"VideoOGG"},rules:{defaults:function(b){if(!b||(b.added&&!a.isArray(b.added))||(b.removed&&!a.isArray(b.removed))||(b.changed&&!a.isArray(b.changed))){return false}return true},open:function(b){return b&&b.cwd&&b.files&&a.isPlainObject(b.cwd)&&a.isArray(b.files)},tree:function(b){return b&&b.tree&&a.isArray(b.tree)},parents:function(b){return b&&b.tree&&a.isArray(b.tree)},tmb:function(b){return b&&b.images&&(a.isPlainObject(b.images)||a.isArray(b.images))},upload:function(b){return b&&(a.isPlainObject(b.added)||a.isArray(b.added))},search:function(b){return b&&b.files&&a.isArray(b.files)}},commands:{},parseUploadData:function(d){var b;if(!a.trim(d)){return{error:["errResponse","errDataEmpty"]}}try{b=a.parseJSON(d)}catch(c){return{error:["errResponse","errDataNotJSON"]}}if(!this.validResponse("upload",b)){return{error:["errResponse"]}}b=this.normalize(b);b.removed=a.map(b.added||[],function(e){return e.hash});return b},iframeCnt:0,uploads:{iframe:function(j,l){var o=l?l:this,m=j.input,c=a.Deferred().fail(function(p){p&&o.error(p)}).done(function(p){p.warning&&o.error(p.warning);p.removed&&o.remove(p);p.added&&o.add(p);p.changed&&o.change(p);o.trigger("upload",p);p.sync&&o.sync()}),b="iframe-"+o.namespace+(++o.iframeCnt),d=a('<form action="'+o.uploadURL+'" method="post" enctype="multipart/form-data" encoding="multipart/form-data" target="'+b+'" style="display:none"><input type="hidden" name="cmd" value="upload" /></form>'),k=this.UA.IE,g=function(){f&&clearTimeout(f);h&&clearTimeout(h);n&&o.notify({type:"upload",cnt:-e});setTimeout(function(){k&&a('<iframe src="javascript:false;"/>').appendTo(d);d.remove();i.remove()},100)},i=a('<iframe src="'+(k?"javascript:false;":"about:blank")+'" name="'+b+'" style="position:absolute;left:-1000px;top:-1000px" />').bind("load",function(){i.unbind("load").bind("load",function(){var p=o.parseUploadData(i.contents().text());g();p.error?c.reject(p.error):c.resolve(p)});h=setTimeout(function(){n=true;o.notify({type:"upload",cnt:e})},o.options.notifyDelay);if(o.options.iframeTimeout>0){f=setTimeout(function(){g();c.reject([errors.connect,errors.timeout])},o.options.iframeTimeout)}d.submit()}),e,n,h,f;if(m&&a(m).is(":file")&&a(m).val()){d.append(m)}else{return c.reject()}e=m.files?m.files.length:1;d.append('<input type="hidden" name="'+(o.newAPI?"target":"current")+'" value="'+o.cwd().hash+'"/>').append('<input type="hidden" name="html" value="1"/>').append(a(m).attr("name","upload[]"));a.each(o.options.onlyMimes||[],function(p,q){d.append('<input type="hidden" name="mimes[]" value="'+q+'"/>')});a.each(o.options.customData,function(p,q){d.append('<input type="hidden" name="'+p+'" value="'+q+'"/>')});d.appendTo("body");i.appendTo("body");return c},xhr:function(i,j){var m=j?j:this,c=a.Deferred().fail(function(n){n&&m.error(n)}).done(function(n){n.warning&&m.error(n.warning);n.removed&&m.remove(n);n.added&&m.add(n);n.changed&&m.change(n);m.trigger("upload",n);n.sync&&m.sync()}).always(function(){g&&clearTimeout(g);k&&m.notify({type:"upload",cnt:-e,progress:100*e})}),l=new XMLHttpRequest(),f=new FormData(),b=i.input?i.input.files:i.files,e=b.length,h=5,k=false,d=function(){return setTimeout(function(){k=true;m.notify({type:"upload",cnt:e,progress:h*e})},m.options.notifyDelay)},g;if(!e){return c.reject()}l.addEventListener("error",function(){c.reject("errConnect")},false);l.addEventListener("abort",function(){c.reject(["errConnect","errAbort"])},false);l.addEventListener("load",function(){var n=l.status,o;if(n>500){return c.reject("errResponse")}if(n!=200){return c.reject("errConnect")}if(l.readyState!=4){return c.reject(["errConnect","errTimeout"])}if(!l.responseText){return c.reject(["errResponse","errDataEmpty"])}o=m.parseUploadData(l.responseText);o.error?c.reject(o.error):c.resolve(o)},false);l.upload.addEventListener("progress",function(p){var n=h,o;if(p.lengthComputable){o=parseInt(p.loaded*100/p.total);if(o>0&&!g){g=d()}if(o-n>4){h=o;k&&m.notify({type:"upload",cnt:0,progress:(h-n)*e})}}},false);l.open("POST",m.uploadURL,true);f.append("cmd","upload");f.append(m.newAPI?"target":"current",m.cwd().hash);a.each(m.options.customData,function(n,o){f.append(n,o)});a.each(m.options.onlyMimes,function(n,o){f.append("mimes["+n+"]",o)});a.each(b,function(o,n){f.append("upload[]",n)});l.onreadystatechange=function(){if(l.readyState==4&&l.status==0){c.reject(["errConnect","errAbort"])}};l.send(f);if(!this.UA.Safari||!i.files){g=d()}return c}},one:function(d,e){var b=this,c=a.proxy(e,function(f){setTimeout(function(){b.unbind(f.type,c)},3);return e.apply(this,arguments)});return this.bind(d,c)},localStorage:function(b,f){var c=window.localStorage;b="elfinder-"+b+this.id;if(f===null){console.log("remove",b);return c.removeItem(b)}if(f!==void (0)){try{c.setItem(b,f)}catch(d){c.clear();c.setItem(b,f)}}return c.getItem(b)},cookie:function(b,f){var h,g,j,e;b="elfinder-"+b+this.id;if(f===void (0)){if(document.cookie&&document.cookie!=""){j=document.cookie.split(";");b+="=";for(e=0;e<j.length;e++){j[e]=a.trim(j[e]);if(j[e].substring(0,b.length)==b){return decodeURIComponent(j[e].substring(b.length))}}}return""}g=a.extend({},this.options.cookie);if(f===null){f="";g.expires=-1}if(typeof(g.expires)=="number"){h=new Date();h.setTime(h.getTime()+(g.expires*86400000));g.expires=h}document.cookie=b+"="+encodeURIComponent(f)+"; expires="+g.expires.toUTCString()+(g.path?"; path="+g.path:"")+(g.domain?"; domain="+g.domain:"")+(g.secure?"; secure":"");return f},lastDir:function(b){return this.options.rememberLastDir?this.storage("lastdir",b):""},_node:a("<span/>"),escape:function(b){return this._node.text(b).html()},normalize:function(c){var b=function(d){if(d&&d.hash&&d.name&&d.mime){if(d.mime=="application/x-empty"){d.mime="text/plain"}return d}return null;return d&&d.hash&&d.name&&d.mime?d:null};if(c.files){c.files=a.map(c.files,b)}if(c.tree){c.tree=a.map(c.tree,b)}if(c.added){c.added=a.map(c.added,b)}if(c.changed){c.changed=a.map(c.changed,b)}if(c.api){c.init=true}return c},setSort:function(d,b,c){this.storage("sortType",(this.sortType=this.sortRules[d]?d:"name"));this.storage("sortOrder",(this.sortOrder=/asc|desc/.test(b)?b:"asc"));this.storage("sortStickFolders",(this.sortStickFolders=!!c)?1:"");this.trigger("sortchange")},_sortRules:{name:function(c,b){return c.name.toLowerCase().localeCompare(b.name.toLowerCase())},size:function(e,c){var d=parseInt(e.size)||0,b=parseInt(c.size)||0;return d==b?0:d>b?1:-1;return(parseInt(e.size)||0)>(parseInt(c.size)||0)?1:-1},kind:function(c,b){return c.mime.localeCompare(b.mime)},date:function(c,b){var e=c.ts||c.date,d=b.ts||b.date;return e==d?0:e>d?1:-1}},compare:function(k,j){var l=this,g=l.sortType,h=l.sortOrder=="asc",e=l.sortStickFolders,i=l.sortRules,d=i[g],c=k.mime=="directory",b=j.mime=="directory",f;if(e){if(c&&!b){return -1}else{if(!c&&b){return 1}}}f=h?d(k,j):d(j,k);return g!="name"&&f==0?f=h?i.name(k,j):i.name(j,k):f},sortFiles:function(b){return b.sort(this.compare)},notify:function(b){var h=b.type,e=this.messages["ntf"+h]?this.i18n("ntf"+h):this.i18n("ntfsmth"),f=this.ui.notify,l=f.children(".elfinder-notify-"+h),k='<div class="elfinder-notify elfinder-notify-{type}"><span class="elfinder-dialog-icon elfinder-dialog-icon-{type}"/><span class="elfinder-notify-msg">{msg}</span> <span class="elfinder-notify-cnt"/><div class="elfinder-notify-progressbar"><div class="elfinder-notify-progress"/></div></div>',j=b.cnt,c=b.progress>=0&&b.progress<=100?b.progress:0,d,i,g;if(!h){return this}if(!l.length){l=a(k.replace(/\{type\}/g,h).replace(/\{msg\}/g,e)).appendTo(f).data("cnt",0);if(c){l.data({progress:0,total:0})}}d=j+parseInt(l.data("cnt"));if(d>0){!b.hideCnt&&l.children(".elfinder-notify-cnt").text("("+d+")");f.is(":hidden")&&f.elfinderdialog("open");l.data("cnt",d);if(c<100&&(i=l.data("total"))>=0&&(g=l.data("progress"))>=0){i=j+parseInt(l.data("total"));g=c+g;c=parseInt(g/i);l.data({progress:g,total:i});f.find(".elfinder-notify-progress").animate({width:(c<100?c:100)+"%"},20)}}else{l.remove();!f.children().length&&f.elfinderdialog("close")}return this},confirm:function(f){var b=false,e={cssClass:"elfinder-dialog-confirm",modal:true,resizable:false,title:this.i18n(f.title||"confirmReq"),buttons:{},close:function(){!b&&f.cancel.callback();a(this).elfinderdialog("destroy")}},c=this.i18n("apllyAll"),d,g;if(f.reject){e.buttons[this.i18n(f.reject.label)]=function(){f.reject.callback(!!(g&&g.prop("checked")));b=true;a(this).elfinderdialog("close")}}e.buttons[this.i18n(f.accept.label)]=function(){f.accept.callback(!!(g&&g.prop("checked")));b=true;a(this).elfinderdialog("close")};e.buttons[this.i18n(f.cancel.label)]=function(){a(this).elfinderdialog("close")};if(f.all){if(f.reject){e.width=370}e.create=function(){g=a('<input type="checkbox" />');a(this).next().children().before(a("<label>"+c+"</label>").prepend(g))};e.open=function(){var i=a(this).next(),h=parseInt(i.children(":first").outerWidth()+i.children(":last").outerWidth());if(h>parseInt(i.width())){a(this).closest(".elfinder-dialog").width(h+30)}}}return this.dialog('<span class="elfinder-dialog-icon elfinder-dialog-icon-confirm"/>'+this.i18n(f.text),e)},uniqueName:function(e,g){var c=0,d="",f,b;e=this.i18n(e);g=g||this.cwd().hash;if((f=e.indexOf(".txt"))!=-1){d=".txt";e=e.substr(0,f)}b=e+d;if(!this.fileByName(b,g)){return b}while(c<10000){b=e+" "+(++c)+d;if(!this.fileByName(b,g)){return b}}return e+Math.random()+d},i18n:function(){var d=this,h=this.messages,c=[],k=[],g=function(i){var j;if(i.indexOf("#")===0){if((j=d.file(i.substr(1)))){return j.name}}return i},f,e,b;for(f=0;f<arguments.length;f++){b=arguments[f];if(typeof b=="string"){c.push(g(b))}else{if(a.isArray(b)){for(e=0;e<b.length;e++){if(typeof b[e]=="string"){c.push(g(b[e]))}}}}}for(f=0;f<c.length;f++){if(a.inArray(f,k)!==-1){continue}b=c[f];b=h[b]||b;b=b.replace(/\$(\d+)/g,function(i,j){j=f+parseInt(j);if(j>0&&c[j]){k.push(j)}return c[j]||""});c[f]=b}return a.map(c,function(j,l){return a.inArray(l,k)===-1?j:null}).join("<br>")},mime2class:function(c){var b="elfinder-cwd-icon-";c=c.split("/");return b+c[0]+(c[0]!="image"&&c[1]?" "+b+c[1].replace(/(\.|\+)/g,"-"):"")},mime2kind:function(d){var c=typeof(d)=="object"?d.mime:d,b;if(d.alias){b="Alias"}else{if(this.kinds[c]){b=this.kinds[c]}else{if(c.indexOf("text")===0){b="Text"}else{if(c.indexOf("image")===0){b="Image"}else{if(c.indexOf("audio")===0){b="Audio"}else{if(c.indexOf("video")===0){b="Video"}else{if(c.indexOf("application")===0){b="App"}else{b=c}}}}}}}return this.messages["kind"+b]?this.i18n("kind"+b):c;var c=typeof(d)=="object"?d.mime:d,b=this.kinds[c]||"unknown";if(d.alias){b="Alias"}else{if(b=="unknown"){if(c.indexOf("text")===0){b="Text"}else{if(c.indexOf("image")===0){b="Image"}else{if(c.indexOf("audio")===0){b="Audio"}else{if(c.indexOf("video")===0){b="Video"}else{if(c.indexOf("application")===0){b="Application"}}}}}}}return this.i18n(b)},formatDate:function(f,q){var u=this,q=q||f.ts,k=u.i18,j,t,c,p,b,e,r,n,o,l,v;if(u.options.clientFormatDate&&q>0){j=new Date(q*1000);n=j[u.getHours]();o=n>12?n-12:n;l=j[u.getMinutes]();v=j[u.getSeconds]();p=j[u.getDate]();b=j[u.getDay]();e=j[u.getMonth]()+1;r=j[u.getFullYear]();t=q>=this.yesterday?this.fancyFormat:this.dateFormat;c=t.replace(/[a-z]/gi,function(d){switch(d){case"d":return p>9?p:"0"+p;case"j":return p;case"D":return u.i18n(k.daysShort[b]);case"l":return u.i18n(k.days[b]);case"m":return e>9?e:"0"+e;case"n":return e;case"M":return u.i18n(k.monthsShort[e-1]);case"F":return u.i18n(k.months[e-1]);case"Y":return r;case"y":return(""+r).substr(2);case"H":return n>9?n:"0"+n;case"G":return n;case"g":return o;case"h":return o>9?o:"0"+o;case"a":return n>12?"pm":"am";case"A":return n>12?"PM":"AM";case"i":return l>9?l:"0"+l;case"s":return v>9?v:"0"+v}return d});return q>=this.yesterday?c.replace("$1",this.i18n(q>=this.today?"Today":"Yesterday")):c}else{if(f.date){return f.date.replace(/([a-z]+)\s/i,function(g,d){return u.i18n(d)+" "})}}return u.i18n("dateUnknown")},perms2class:function(b){var d="";if(!b.read&&!b.write){d="elfinder-na"}else{if(!b.read){d="elfinder-wo"}else{if(!b.write){d="elfinder-ro"}}}return d},formatPermissions:function(b){var c=[];b.read&&c.push(this.i18n("read"));b.write&&c.push(this.i18n("write"));return c.length?c.join(" "+this.i18n("and")+" "):this.i18n("noaccess")},formatSize:function(c){var d=1,b="b";if(c=="unknown"){return this.i18n("unknown")}if(c>1073741824){d=1073741824;b="GB"}else{if(c>1048576){d=1048576;b="MB"}else{if(c>1024){d=1024;b="KB"}}}c=c/d;return(c>0?d>=1048576?c.toFixed(2):Math.round(c):0)+" "+b},navHash2Id:function(b){return"nav-"+b},navId2Hash:function(b){return typeof(b)=="string"?b.substr(4):false},log:function(b){window.console&&window.console.log&&window.console.log(b);return this},debug:function(c,b){var e=this.options.debug;if(e=="all"||e===true||(a.isArray(e)&&a.inArray(c,e)!=-1)){window.console&&window.console.log&&window.console.log("elfinder debug: ["+c+"] ["+this.id+"]",b)}return this},time:function(b){window.console&&window.console.time&&window.console.time(b)},timeEnd:function(b){window.console&&window.console.timeEnd&&window.console.timeEnd(b)}};elFinder.prototype.version="2.0.2";a.fn.elfinder=function(b){if(b=="instance"){return this.getElFinder()}return this.each(function(){var c=typeof(b)=="string"?b:"";if(!this.elfinder){new elFinder(this,typeof(b)=="object"?b:{})}switch(c){case"close":case"hide":this.elfinder.hide();break;case"open":case"show":this.elfinder.show();break;case"destroy":this.elfinder.destroy();break}})};a.fn.getElFinder=function(){var b;this.each(function(){if(this.elfinder){b=this.elfinder;return false}});return b};elFinder.prototype._options={url:"",requestType:"get",transport:{},urlUpload:"",dragUploadAllow:"auto",iframeTimeout:0,customData:{},handlers:{},lang:"en",cssClass:"",commands:["open","reload","home","up","back","forward","getfile","quicklook","download","rm","duplicate","rename","mkdir","mkfile","upload","copy","cut","paste","edit","extract","archive","search","info","view","help","resize","sort","netmount"],commandsOptions:{getfile:{onlyURL:false,multiple:false,folders:false,oncomplete:""},upload:{ui:"uploadbutton"},quicklook:{autoplay:true,jplayer:"extensions/jplayer"},edit:{mimes:[],editors:[]},help:{view:["about","shortcuts","help"]}},getFileCallback:null,defaultView:"icons",ui:["toolbar","tree","path","stat"],uiOptions:{toolbar:[["back","forward"],["netmount"],["mkdir","mkfile","upload"],["open","download","getfile"],["info"],["quicklook"],["copy","cut","paste"],["rm"],["duplicate","rename","edit","resize"],["extract","archive"],["search"],["view","sort"],["help"]],tree:{openRootOnLoad:true,syncTree:true},navbar:{minWidth:150,maxWidth:500},cwd:{oldSchool:false}},onlyMimes:[],sortRules:{},sortType:"name",sortOrder:"asc",sortStickFolders:true,clientFormatDate:true,UTCDate:false,dateFormat:"",fancyDateFormat:"",width:"auto",height:400,resizable:true,notifyDelay:500,allowShortcuts:true,rememberLastDir:true,showFiles:30,showThreshold:50,validName:false,sync:0,loadTmbs:5,cookie:{expires:30,domain:"",path:"/",secure:false},contextmenu:{navbar:["open","|","copy","cut","paste","duplicate","|","rm","|","info"],cwd:["reload","back","|","upload","mkdir","mkfile","paste","|","sort","|","info"],files:["getfile","|","open","quicklook","|","download","|","copy","cut","paste","duplicate","|","rm","|","edit","rename","resize","|","archive","extract","|","info"]},debug:["error","warning","event-destroy"]};elFinder.prototype.history=function(e){var b=this,h=true,g=[],f,d=function(){g=[e.cwd().hash];f=0;h=true},c=function(i){if((i&&b.canForward())||(!i&&b.canBack())){h=false;return e.exec("open",g[i?++f:--f]).fail(d)}return a.Deferred().reject()};this.canBack=function(){return f>0};this.canForward=function(){return f<g.length-1};this.back=c;this.forward=function(){return c(true)};e.open(function(k){var i=g.length,j=e.cwd().hash;if(h){f>=0&&i>f+1&&g.splice(f+1);g[g.length-1]!=j&&g.push(j);f=g.length-1}h=true}).reload(d)};elFinder.prototype.command=function(b){this.fm=b;this.name="";this.title="";this.state=-1;this.alwaysEnabled=false;this._disabled=false;this.disableOnSearch=false;this.updateOnSelect=true;this._handlers={enable:function(){this.update(void (0),this.value)},disable:function(){this.update(-1,this.value)},"open reload load":function(c){this._disabled=!(this.alwaysEnabled||this.fm.isCommandEnabled(this.name));this.update(void (0),this.value);this.change()}};this.handlers={};this.shortcuts=[];this.options={ui:"button"};this.setup=function(d,h){var c=this,g=this.fm,e,f;this.name=d;this.title=g.messages["cmd"+d]?g.i18n("cmd"+d):d,this.options=a.extend({},this.options,h);this.listeners=[];if(this.updateOnSelect){this._handlers.select=function(){this.update(void (0),this.value)}}a.each(a.extend({},c._handlers,c.handlers),function(j,i){g.bind(j,a.proxy(i,c))});for(e=0;e<this.shortcuts.length;e++){f=this.shortcuts[e];f.callback=a.proxy(f.callback||function(){this.exec()},this);!f.description&&(f.description=this.title);g.shortcut(f)}if(this.disableOnSearch){g.bind("search searchend",function(i){c._disabled=i.type=="search";c.update(void (0),c.value)})}this.init()};this.init=function(){};this.exec=function(d,c){return a.Deferred().reject()};this.disabled=function(){return this.state<0};this.enabled=function(){return this.state>-1};this.active=function(){return this.state>0};this.getstate=function(){return -1};this.update=function(d,c){var f=this.state,e=this.value;if(this._disabled){this.state=-1}else{this.state=d!==void (0)?d:this.getstate()}this.value=c;if(f!=this.state||e!=this.value){this.change()}};this.change=function(h){var f,d;if(typeof(h)==="function"){this.listeners.push(h)}else{for(d=0;d<this.listeners.length;d++){f=this.listeners[d];try{f(this.state,this.value)}catch(g){this.fm.debug("error",g)}}}return this};this.hashes=function(c){return c?a.map(a.isArray(c)?c:[c],function(d){return b.file(d)?d:null}):b.selected()};this.files=function(c){var d=this.fm;return c?a.map(a.isArray(c)?c:[c],function(e){return d.file(e)||null}):d.selectedFiles()}};"use strict";elFinder.prototype.resources={"class":{hover:"ui-state-hover",active:"ui-state-active",disabled:"ui-state-disabled",draggable:"ui-draggable",droppable:"ui-droppable",adroppable:"elfinder-droppable-active",cwdfile:"elfinder-cwd-file",cwd:"elfinder-cwd",tree:"elfinder-tree",treeroot:"elfinder-navbar-root",navdir:"elfinder-navbar-dir",navdirwrap:"elfinder-navbar-dir-wrapper",navarrow:"elfinder-navbar-arrow",navsubtree:"elfinder-navbar-subtree",navcollapse:"elfinder-navbar-collapsed",navexpand:"elfinder-navbar-expanded",treedir:"elfinder-tree-dir",placedir:"elfinder-place-dir",searchbtn:"elfinder-button-search"},tpl:{perms:'<span class="elfinder-perms"/>',symlink:'<span class="elfinder-symlink"/>',navicon:'<span class="elfinder-nav-icon"/>',navspinner:'<span class="elfinder-navbar-spinner"/>',navdir:'<div class="elfinder-navbar-wrapper"><span id="{id}" class="ui-corner-all elfinder-navbar-dir {cssclass}"><span class="elfinder-navbar-arrow"/><span class="elfinder-navbar-icon"/>{symlink}{permissions}{name}</span><div class="elfinder-navbar-subtree"/></div>'},mimes:{text:["application/x-empty","application/javascript","application/xhtml+xml","audio/x-mp3-playlist","application/x-web-config","application/docbook+xml","application/x-php","application/x-perl","application/x-awk","application/x-config","application/x-csh","application/xml"]},mixin:{make:function(){var j=this.fm,e=this.name,k=j.getUI("cwd"),b=a.Deferred().fail(function(l){k.trigger("unselectall");l&&j.error(l)}).always(function(){i.remove();d.remove();j.enable()}),c="tmp_"+parseInt(Math.random()*100000),h=j.cwd().hash,g=new Date(),f={hash:c,name:j.uniqueName(this.prefix),mime:this.mime,read:true,write:true,date:"Today "+g.getHours()+":"+g.getMinutes()},d=k.trigger("create."+j.namespace,f).find("#"+c),i=a('<input type="text"/>').keydown(function(l){l.stopImmediatePropagation();if(l.keyCode==a.ui.keyCode.ESCAPE){b.reject()}else{if(l.keyCode==a.ui.keyCode.ENTER){i.blur()}}}).mousedown(function(l){l.stopPropagation()}).blur(function(){var l=a.trim(i.val()),m=i.parent();if(m.length){if(!l){return b.reject("errInvName")}if(j.fileByName(l,h)){return b.reject(["errExists",l])}m.html(j.escape(l));j.lockfiles({files:[c]});j.request({data:{cmd:e,name:l,target:h},notify:{type:e,cnt:1},preventFail:true,syncOnFail:true}).fail(function(n){b.reject(n)}).done(function(n){b.resolve(n)})}});if(this.disabled()||!d.length){return b.reject()}j.disable();d.find(".elfinder-cwd-filename").empty("").append(i.val(f.name));i.select().focus();return b}}};"use strict";a.fn.dialogelfinder=function(f){var b="elfinderPosition",d="elfinderDestroyOnClose";this.not(".elfinder").each(function(){var l=a(document),k=a('<div class="ui-widget-header dialogelfinder-drag ui-corner-top">'+(f.title||"Files")+"</div>"),i=a('<a href="#" class="dialogelfinder-drag-close ui-corner-all"><span class="ui-icon ui-icon-closethick"/></a>').appendTo(k).click(function(m){m.preventDefault();j.dialogelfinder("close")}),j=a(this).addClass("dialogelfinder").css("position","absolute").hide().appendTo("body").draggable({handle:".dialogelfinder-drag",containment:"window"}).elfinder(f).prepend(k),h=j.elfinder("instance");j.width(parseInt(j.width())||840).data(d,!!f.destroyOnClose).find(".elfinder-toolbar").removeClass("ui-corner-top");f.position&&j.data(b,f.position);f.autoOpen!==false&&a(this).dialogelfinder("open")});if(f=="open"){var e=a(this),g=e.data(b)||{top:parseInt(a(document).scrollTop()+(a(window).height()<e.height()?2:(a(window).height()-e.height())/2)),left:parseInt(a(document).scrollLeft()+(a(window).width()<e.width()?2:(a(window).width()-e.width())/2))},c=100;if(e.is(":hidden")){a("body").find(":visible").each(function(){var h=a(this),i;if(this!==e[0]&&h.css("position")=="absolute"&&(i=parseInt(h.zIndex()))>c){c=i+1}});e.zIndex(c).css(g).show().trigger("resize");setTimeout(function(){e.trigger("resize").mousedown()},200)}}else{if(f=="close"){var e=a(this);if(e.is(":visible")){!!e.data(d)?e.elfinder("destroy").remove():e.elfinder("close")}}else{if(f=="instance"){return a(this).getElFinder()}}}return this};if(elFinder&&elFinder.prototype&&typeof(elFinder.prototype.i18)=="object"){elFinder.prototype.i18.en={translator:"Troex Nevelin &lt;troex@fury.scancode.ru&gt;",language:"English",direction:"ltr",dateFormat:"M d, Y h:i A",fancyDateFormat:"$1 h:i A",messages:{error:"Error",errUnknown:"Unknown error.",errUnknownCmd:"Unknown command.",errJqui:"Invalid jQuery UI configuration. Selectable, draggable and droppable components must be included.",errNode:"elFinder requires DOM Element to be created.",errURL:"Invalid elFinder configuration! URL option is not set.",errAccess:"Access denied.",errConnect:"Unable to connect to backend.",errAbort:"Connection aborted.",errTimeout:"Connection timeout.",errNotFound:"Backend not found.",errResponse:"Invalid backend response.",errConf:"Invalid backend configuration.",errJSON:"PHP JSON module not installed.",errNoVolumes:"Readable volumes not available.",errCmdParams:'Invalid parameters for command "$1".',errDataNotJSON:"Data is not JSON.",errDataEmpty:"Data is empty.",errCmdReq:"Backend request requires command name.",errOpen:'Unable to open "$1".',errNotFolder:"Object is not a folder.",errNotFile:"Object is not a file.",errRead:'Unable to read "$1".',errWrite:'Unable to write into "$1".',errPerm:"Permission denied.",errLocked:'"$1" is locked and can not be renamed, moved or removed.',errExists:'File named "$1" already exists.',errInvName:"Invalid file name.",errFolderNotFound:"Folder not found.",errFileNotFound:"File not found.",errTrgFolderNotFound:'Target folder "$1" not found.',errPopup:"Browser prevented opening popup window. To open file enable it in browser options.",errMkdir:'Unable to create folder "$1".',errMkfile:'Unable to create file "$1".',errRename:'Unable to rename "$1".',errCopyFrom:'Copying files from volume "$1" not allowed.',errCopyTo:'Copying files to volume "$1" not allowed.',errUpload:"Upload error.",errUploadFile:'Unable to upload "$1".',errUploadNoFiles:"No files found for upload.",errUploadTotalSize:"Data exceeds the maximum allowed size.",errUploadFileSize:"File exceeds maximum allowed size.",errUploadMime:"File type not allowed.",errUploadTransfer:'"$1" transfer error.',errNotReplace:'Object "$1" already exists at this location and can not be replaced by object with another type.',errReplace:'Unable to replace "$1".',errSave:'Unable to save "$1".',errCopy:'Unable to copy "$1".',errMove:'Unable to move "$1".',errCopyInItself:'Unable to copy "$1" into itself.',errRm:'Unable to remove "$1".',errRmSrc:"Unable remove source file(s).",errExtract:'Unable to extract files from "$1".',errArchive:"Unable to create archive.",errArcType:"Unsupported archive type.",errNoArchive:"File is not archive or has unsupported archive type.",errCmdNoSupport:"Backend does not support this command.",errReplByChild:"The folder “$1” can’t be replaced by an item it contains.",errArcSymlinks:"For security reason denied to unpack archives contains symlinks or files with not allowed names.",errArcMaxSize:"Archive files exceeds maximum allowed size.",errResize:'Unable to resize "$1".',errUsupportType:"Unsupported file type.",errNotUTF8Content:'File "$1" is not in UTF-8 and cannot be edited.',errNetMount:'Unable to mount "$1".',errNetMountNoDriver:"Unsupported protocol.",errNetMountFailed:"Mount failed.",errNetMountHostReq:"Host required.",errSessionExpires:"Your session has expired due to inactivity.",errCreatingTempDir:'Unable to create temporary directory: "$1"',errFtpDownloadFile:'Unable to download file from FTP: "$1"',errFtpUploadFile:'Unable to upload file to FTP: "$1"',errFtpMkdir:'Unable to create remote directory on FTP: "$1"',errArchiveExec:'Error while archiving files: "$1"',errExtractExec:'Error while extracting files: "$1"',cmdarchive:"Create archive",cmdback:"Back",cmdcopy:"Copy",cmdcut:"Cut",cmddownload:"Download",cmdduplicate:"Duplicate",cmdedit:"Edit file",cmdextract:"Extract files from archive",cmdforward:"Forward",cmdgetfile:"Select files",cmdhelp:"About this software",cmdhome:"Home",cmdinfo:"Get info",cmdmkdir:"New folder",cmdmkfile:"New text file",cmdopen:"Open",cmdpaste:"Paste",cmdquicklook:"Preview",cmdreload:"Reload",cmdrename:"Rename",cmdrm:"Delete",cmdsearch:"Find files",cmdup:"Go to parent directory",cmdupload:"Upload files",cmdview:"View",cmdresize:"Resize & Rotate",cmdsort:"Sort",cmdnetmount:"Mount network volume",btnClose:"Close",btnSave:"Save",btnRm:"Remove",btnApply:"Apply",btnCancel:"Cancel",btnNo:"No",btnYes:"Yes",btnMount:"Mount",ntfopen:"Open folder",ntffile:"Open file",ntfreload:"Reload folder content",ntfmkdir:"Creating directory",ntfmkfile:"Creating files",ntfrm:"Delete files",ntfcopy:"Copy files",ntfmove:"Move files",ntfprepare:"Prepare to copy files",ntfrename:"Rename files",ntfupload:"Uploading files",ntfdownload:"Downloading files",ntfsave:"Save files",ntfarchive:"Creating archive",ntfextract:"Extracting files from archive",ntfsearch:"Searching files",ntfresize:"Resizing images",ntfsmth:"Doing something",ntfloadimg:"Loading image",ntfnetmount:"Mounting network volume",dateUnknown:"unknown",Today:"Today",Yesterday:"Yesterday",Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",May:"May",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec",sortname:"by name",sortkind:"by kind",sortsize:"by size",sortdate:"by date",sortFoldersFirst:"Folders first",confirmReq:"Confirmation required",confirmRm:"Are you sure you want to remove files?<br/>This cannot be undone!",confirmRepl:"Replace old file with new one?",apllyAll:"Apply to all",name:"Name",size:"Size",perms:"Permissions",modify:"Modified",kind:"Kind",read:"read",write:"write",noaccess:"no access",and:"and",unknown:"unknown",selectall:"Select all files",selectfiles:"Select file(s)",selectffile:"Select first file",selectlfile:"Select last file",viewlist:"List view",viewicons:"Icons view",places:"Places",calc:"Calculate",path:"Path",aliasfor:"Alias for",locked:"Locked",dim:"Dimensions",files:"Files",folders:"Folders",items:"Items",yes:"yes",no:"no",link:"Link",searcresult:"Search results",selected:"selected items",about:"About",shortcuts:"Shortcuts",help:"Help",webfm:"Web file manager",ver:"Version",protocolver:"protocol version",homepage:"Project home",docs:"Documentation",github:"Fork us on Github",twitter:"Follow us on twitter",facebook:"Join us on facebook",team:"Team",chiefdev:"chief developer",developer:"developer",contributor:"contributor",maintainer:"maintainer",translator:"translator",icons:"Icons",dontforget:"and don't forget to take your towel",shortcutsof:"Shortcuts disabled",dropFiles:"Drop files here",or:"or",selectForUpload:"Select files to upload",moveFiles:"Move files",copyFiles:"Copy files",rmFromPlaces:"Remove from places",aspectRatio:"Aspect ratio",scale:"Scale",width:"Width",height:"Height",resize:"Resize",crop:"Crop",rotate:"Rotate","rotate-cw":"Rotate 90 degrees CW","rotate-ccw":"Rotate 90 degrees CCW",degree:"°",netMountDialogTitle:"Mount network volume",protocol:"Protocol",host:"Host",port:"Port",user:"User",pass:"Password",kindUnknown:"Unknown",kindFolder:"Folder",kindAlias:"Alias",kindAliasBroken:"Broken alias",kindApp:"Application",kindPostscript:"Postscript document",kindMsOffice:"Microsoft Office document",kindMsWord:"Microsoft Word document",kindMsExcel:"Microsoft Excel document",kindMsPP:"Microsoft Powerpoint presentation",kindOO:"Open Office document",kindAppFlash:"Flash application",kindPDF:"Portable Document Format (PDF)",kindTorrent:"Bittorrent file",kind7z:"7z archive",kindTAR:"TAR archive",kindGZIP:"GZIP archive",kindBZIP:"BZIP archive",kindZIP:"ZIP archive",kindRAR:"RAR archive",kindJAR:"Java JAR file",kindTTF:"True Type font",kindOTF:"Open Type font",kindRPM:"RPM package",kindText:"Text document",kindTextPlain:"Plain text",kindPHP:"PHP source",kindCSS:"Cascading style sheet",kindHTML:"HTML document",kindJS:"Javascript source",kindRTF:"Rich Text Format",kindC:"C source",kindCHeader:"C header source",kindCPP:"C++ source",kindCPPHeader:"C++ header source",kindShell:"Unix shell script",kindPython:"Python source",kindJava:"Java source",kindRuby:"Ruby source",kindPerl:"Perl script",kindSQL:"SQL source",kindXML:"XML document",kindAWK:"AWK source",kindCSV:"Comma separated values",kindDOCBOOK:"Docbook XML document",kindImage:"Image",kindBMP:"BMP image",kindJPEG:"JPEG image",kindGIF:"GIF Image",kindPNG:"PNG Image",kindTIFF:"TIFF image",kindTGA:"TGA image",kindPSD:"Adobe Photoshop image",kindXBITMAP:"X bitmap image",kindPXM:"Pixelmator image",kindAudio:"Audio media",kindAudioMPEG:"MPEG audio",kindAudioMPEG4:"MPEG-4 audio",kindAudioMIDI:"MIDI audio",kindAudioOGG:"Ogg Vorbis audio",kindAudioWAV:"WAV audio",AudioPlaylist:"MP3 playlist",kindVideo:"Video media",kindVideoDV:"DV movie",kindVideoMPEG:"MPEG movie",kindVideoMPEG4:"MPEG-4 movie",kindVideoAVI:"AVI movie",kindVideoMOV:"Quick Time movie",kindVideoWM:"Windows Media movie",kindVideoFlash:"Flash movie",kindVideoMKV:"Matroska movie",kindVideoOGG:"Ogg movie"}}}"use strict";a.fn.elfinderbutton=function(b){return this.each(function(){var j="class",l=b.fm,f=l.res(j,"disabled"),e=l.res(j,"active"),i=l.res(j,"hover"),m="elfinder-button-menu-item",g="elfinder-button-menu-item-selected",d,h=a(this).addClass("ui-state-default elfinder-button").attr("title",b.title).append('<span class="elfinder-button-icon elfinder-button-icon-'+b.name+'"/>').hover(function(c){!h.is("."+f)&&h[c.type=="mouseleave"?"removeClass":"addClass"](i)}).click(function(c){if(!h.is("."+f)){if(d&&b.variants.length>1){d.is(":hidden")&&b.fm.getUI().click();c.stopPropagation();d.slideToggle(100)}else{b.exec()}}}),k=function(){d.hide()};if(a.isArray(b.variants)){h.addClass("elfinder-menubutton");d=a('<div class="ui-widget ui-widget-content elfinder-button-menu ui-corner-all"/>').hide().appendTo(h).zIndex(12+h.zIndex()).delegate("."+m,"hover",function(){a(this).toggleClass(i)}).delegate("."+m,"click",function(c){c.preventDefault();c.stopPropagation();h.removeClass(i);b.exec(b.fm.selected(),a(this).data("value"))});b.fm.bind("disable select",k).getUI().click(k);b.change(function(){d.html("");a.each(b.variants,function(n,c){d.append(a('<div class="'+m+'">'+c[1]+"</div>").data("value",c[0]).addClass(c[0]==b.value?g:""))})})}b.change(function(){if(b.disabled()){h.removeClass(e+" "+i).addClass(f)}else{h.removeClass(f);h[b.active()?"addClass":"removeClass"](e)}}).change()})};"use strict";a.fn.elfindercontextmenu=function(b){return this.each(function(){var c=a(this).addClass("ui-helper-reset ui-widget ui-state-default ui-corner-all elfinder-contextmenu elfinder-contextmenu-"+b.direction).hide().appendTo("body").delegate(".elfinder-contextmenu-item","mouseenter mouseleave",function(){a(this).toggleClass("ui-state-hover")}),d=b.direction=="ltr"?"left":"right",g=a.extend({},b.options.contextmenu),h='<div class="elfinder-contextmenu-item"><span class="elfinder-button-icon {icon} elfinder-contextmenu-icon"/><span>{label}</span></div>',k=function(l,m,n){return a(h.replace("{icon}",m?"elfinder-button-icon-"+m:"").replace("{label}",l)).click(function(o){o.stopPropagation();o.stopPropagation();n()})},f=function(s,r){var p=a(window),l=c.outerWidth(),t=c.outerHeight(),q=p.width(),n=p.height(),m=p.scrollTop(),u=p.scrollLeft(),o={top:(r+t<n?r:r-t>0?r-t:r)+m,left:(s+l<q?s:s-l)+u,"z-index":100+b.getUI("workzone").zIndex()};c.css(o).show();o={"z-index":o["z-index"]+10};o[d]=parseInt(c.width());c.find(".elfinder-contextmenu-sub").css(o)},j=function(){c.hide().empty()},e=function(n,l){var m=false;a.each(g[n]||[],function(p,o){var s,r,q;if(o=="|"&&m){c.append('<div class="elfinder-contextmenu-separator"/>');m=false;return}s=b.command(o);if(s&&s.getstate(l)!=-1){if(s.variants){if(!s.variants.length){return}r=k(s.title,s.name,function(){});q=a('<div class="ui-corner-all elfinder-contextmenu-sub"/>').appendTo(r.append('<span class="elfinder-contextmenu-arrow"/>'));r.addClass("elfinder-contextmenu-group").hover(function(){q.toggle()});a.each(s.variants,function(u,t){q.append(a('<div class="elfinder-contextmenu-item"><span>'+t[1]+"</span></div>").click(function(v){v.stopPropagation();j();s.exec(l,t[0])}))})}else{r=k(s.title,s.name,function(){j();s.exec(l)})}c.append(r);m=true}})},i=function(l){a.each(l,function(m,o){var n;if(o.label&&typeof o.callback=="function"){n=k(o.label,o.icon,function(){j();o.callback()});c.append(n)}})};b.one("load",function(){b.bind("contextmenu",function(m){var l=m.data;j();if(l.type&&l.targets){e(l.type,l.targets)}else{if(l.raw){i(l.raw)}}c.children().length&&f(l.x,l.y)}).one("destroy",function(){c.remove()}).bind("disable select",j).getUI().click(j)})})};"use strict";a.fn.elfindercwd=function(c,b){this.not(".elfinder-cwd").each(function(){var s=c.viewType=="list",x="undefined",R="select."+c.namespace,L="unselect."+c.namespace,q="disable."+c.namespace,i="enable."+c.namespace,aa="class",M=c.res(aa,"cwdfile"),V="."+M,D="ui-selected",G=c.res(aa,"disabled"),Z=c.res(aa,"draggable"),h=c.res(aa,"droppable"),d=c.res(aa,"hover"),v=c.res(aa,"adroppable"),I=M+"-tmp",W=c.options.loadTmbs>0?c.options.loadTmbs:5,Y="",t=[],e={icon:'<div id="{hash}" class="'+M+' {permsclass} {dirclass} ui-corner-all" title="{tooltip}"><div class="elfinder-cwd-file-wrapper ui-corner-all"><div class="elfinder-cwd-icon {mime} ui-corner-all" unselectable="on" {style}/>{marker}</div><div class="elfinder-cwd-filename" title="{name}">{name}</div></div>',row:'<tr id="{hash}" class="'+M+' {permsclass} {dirclass}" title="{tooltip}"><td><div class="elfinder-cwd-file-wrapper"><span class="elfinder-cwd-icon {mime}"/>{marker}<span class="elfinder-cwd-filename">{name}</span></div></td><td>{perms}</td><td>{date}</td><td>{size}</td><td>{kind}</td></tr>'},O=c.res("tpl","perms"),Q=c.res("tpl","symlink"),A={permsclass:function(ab){return c.perms2class(ab)},perms:function(ab){return c.formatPermissions(ab)},dirclass:function(ab){return ab.mime=="directory"?"directory":""},mime:function(ab){return c.mime2class(ab.mime)},size:function(ab){return c.formatSize(ab.size)},date:function(ab){return c.formatDate(ab)},kind:function(ab){return c.mime2kind(ab)},marker:function(ab){return(ab.alias||ab.mime=="symlink-broken"?Q:"")+(!ab.read||!ab.write?O:"")},tooltip:function(ab){var ac=c.formatDate(ab)+(ab.size>0?" ("+c.formatSize(ab.size)+")":"");return ab.tooltip?c.escape(ab.tooltip).replace(/"/g,"&quot;").replace(/\r/g,"&#13;")+"&#13;"+ac:ac}},m=function(ab){ab.name=c.escape(ab.name);return e[s?"row":"icon"].replace(/\{([a-z]+)\}/g,function(ac,ad){return A[ad]?A[ad](ab):(ab[ad]?ab[ad]:"")})},U=false,N=function(al,ad){var ab=a.ui.keyCode,ah=al==ab.LEFT||al==ab.UP,ac=F.find("[id]."+D),ai=ah?"first:":"last",am,af,ae,aj,ag;function ak(ao,an){return ao[an+"All"]("[id]:not(."+G+"):not(.elfinder-cwd-parent):first")}if(ac.length){am=ac.filter(ah?":first":":last");ae=ak(am,ah?"prev":"next");if(!ae.length){af=am}else{if(s||al==ab.LEFT||al==ab.RIGHT){af=ae}else{aj=am.position().top;ag=am.position().left;af=am;if(ah){do{af=af.prev("[id]")}while(af.length&&!(af.position().top<aj&&af.position().left<=ag));if(af.is("."+G)){af=ak(af,"next")}}else{do{af=af.next("[id]")}while(af.length&&!(af.position().top>aj&&af.position().left>=ag));if(af.is("."+G)){af=ak(af,"prev")}if(!af.length){ae=F.find("[id]:not(."+G+"):last");if(ae.position().top>aj){af=ae}}}}}}else{af=F.find("[id]:not(."+G+"):not(.elfinder-cwd-parent):"+(ah?"last":"first"))}if(af&&af.length&&!af.is(".elfinder-cwd-parent")){if(ad){af=am.add(am[ah?"prevUntil":"nextUntil"]("#"+af.attr("id"))).add(af)}else{ac.trigger(L)}af.trigger(R);K(af.filter(ah?":first":":last"));B()}},z=[],l=function(ab){F.find("#"+ab).trigger(R)},X=function(){var ab=c.cwd().hash;F.find("[id]:not(."+D+"):not(.elfinder-cwd-parent)").trigger(R);z=a.map(c.files(),function(ac){return ac.phash==ab?ac.hash:null});B()},S=function(){z=[];F.find("[id]."+D).trigger(L);B()},y=function(){return z},B=function(){c.trigger("select",{selected:z})},K=function(ae){var af=ae.position().top,ab=ae.outerHeight(true),ac=r.scrollTop(),ad=r.innerHeight();if(af+ab>ac+ad){r.scrollTop(parseInt(af+ab-ad))}else{if(af<ac){r.scrollTop(af)}}},u=[],E=function(ac){var ab=u.length;while(ab--){if(u[ab].hash==ac){return ab}}return -1},J="scroll."+c.namespace,C=function(){var ae=[],ai=false,ad=[],ac={},ag=F.find("[id]:last"),ah=!ag.length,ab=s?F.children("table").children("tbody"):F,af;if(!u.length){return r.unbind(J)}while((!ag.length||ag.position().top<=r.height()+r.scrollTop()+c.options.showThreshold)&&(af=u.splice(0,c.options.showFiles)).length){ae=a.map(af,function(aj){if(aj.hash&&aj.name){if(aj.mime=="directory"){ai=true}if(aj.tmb){aj.tmb===1?ad.push(aj.hash):(ac[aj.hash]=aj.tmb)}return m(aj)}return null});ab.append(ae.join(""));ag=F.find("[id]:last");ah&&F.scrollTop(0)}p(ac);ad.length&&o(ad);ai&&P();if(z.length){ab.find("[id]:not(."+D+"):not(.elfinder-cwd-parent)").each(function(){var aj=this.id;a.inArray(aj,z)!==-1&&a(this).trigger(R)})}},g=a.extend({},c.droppable,{over:function(ad,ab){var ac=c.cwd().hash;a.each(ab.helper.data("files"),function(ae,af){if(c.file(af).phash==ac){F.removeClass(v);return false}})}}),P=function(){setTimeout(function(){F.find(".directory:not(."+h+",.elfinder-na,.elfinder-ro)").droppable(c.droppable)},20)},p=function(ab){var ae=c.option("tmbUrl"),ad=true,ac;a.each(ab,function(ah,ag){var af=F.find("#"+ah);if(af.length){(function(ai,aj){a("<img/>").load(function(){ai.find(".elfinder-cwd-icon").css("background","url('"+aj+"') center center no-repeat")}).attr("src",aj)})(af,ae+ag)}else{ad=false;if((ac=E(ah))!=-1){u[ac].tmb=ag}}});return ad},o=function(ac){var ab=[];if(c.oldAPI){c.request({data:{cmd:"tmb",current:c.cwd().hash},preventFail:true}).done(function(ad){if(p(ad.images||[])&&ad.tmb){o()}});return}ab=ab=ac.splice(0,W);if(ab.length){c.request({data:{cmd:"tmb",targets:ab},preventFail:true}).done(function(ad){if(p(ad.images||[])){o(ac)}})}},f=function(ad){var ai=s?F.find("tbody"):F,ah=ad.length,al=[],ak={},ac=false,ag=function(an){var ap=F.find("[id]:first"),ao;while(ap.length){ao=c.file(ap.attr("id"));if(!ap.is(".elfinder-cwd-parent")&&ao&&c.compare(an,ao)<0){return ap}ap=ap.next("[id]")}},ab=function(ap){var an=u.length,ao;for(ao=0;ao<an;ao++){if(c.compare(ap,u[ao])<0){return ao}}return an||-1},af,aj,ae,am;while(ah--){af=ad[ah];aj=af.hash;if(F.find("#"+aj).length){continue}if((ae=ag(af))&&ae.length){ae.before(m(af))}else{if((am=ab(af))>=0){u.splice(am,0,af)}else{ai.append(m(af))}}if(F.find("#"+aj).length){if(af.mime=="directory"){ac=true}else{if(af.tmb){af.tmb===1?al.push(aj):(ak[aj]=af.tmb)}}}}p(ak);al.length&&o(al);ac&&P()},w=function(ad){var ab=ad.length,af,ag,ac;while(ab--){af=ad[ab];if((ag=F.find("#"+af)).length){try{ag.detach()}catch(ae){c.debug("error",ae)}}else{if((ac=E(af))!=-1){u.splice(ac,1)}}}},H={name:c.i18n("name"),perm:c.i18n("perms"),mod:c.i18n("modify"),size:c.i18n("size"),kind:c.i18n("kind")},k=function(ac,ad){var af=c.cwd().hash;S();try{F.children("table,"+V).remove()}catch(ae){F.html("")}F.removeClass("elfinder-cwd-view-icons elfinder-cwd-view-list").addClass("elfinder-cwd-view-"+(s?"list":"icons"));r[s?"addClass":"removeClass"]("elfinder-cwd-wrapper-list");s&&F.html('<table><thead><tr class="ui-state-default"><td >'+H.name+"</td><td>"+H.perm+"</td><td>"+H.mod+"</td><td>"+H.size+"</td><td>"+H.kind+"</td></tr></thead><tbody/></table>");u=a.map(ac,function(ag){return ad||ag.phash==af?ag:null});u=c.sortFiles(u);r.bind(J,C).trigger(J);af=c.cwd().phash;if(b.oldSchool&&af&&!Y){var ab=a.extend(true,{},c.file(af),{name:"..",mime:"directory"});ab=a(m(ab)).addClass("elfinder-cwd-parent").bind("mousedown click mouseup dblclick mouseenter",function(ag){ag.preventDefault();ag.stopPropagation()}).dblclick(function(){c.exec("open",this.id)});(s?F.find("tbody"):F).prepend(ab)}},F=a(this).addClass("ui-helper-clearfix elfinder-cwd").attr("unselectable","on").delegate(V,"click."+c.namespace,function(ah){var ag=this.id?a(this):a(this).parents("[id]:first"),af=ag.prevAll("."+D+":first"),ae=ag.nextAll("."+D+":first"),ad=af.length,ab=ae.length,ac;ah.stopImmediatePropagation();if(ah.shiftKey&&(ad||ab)){ac=ad?ag.prevUntil("#"+af.attr("id")):ag.nextUntil("#"+ae.attr("id"));ac.add(ag).trigger(R)}else{if(ah.ctrlKey||ah.metaKey){ag.trigger(ag.is("."+D)?L:R)}else{S();ag.trigger(R)}}B()}).delegate(V,"dblclick."+c.namespace,function(ab){c.dblclick({file:this.id})}).delegate(V,"mouseenter."+c.namespace,function(ad){var ac=a(this),ab=s?ac:ac.children();if(!ac.is("."+I)&&!ab.is("."+Z+",."+G)){ab.draggable(c.draggable)}}).delegate(V,R,function(ac){var ab=a(this),ad=ab.attr("id");if(!U&&!ab.is("."+G)){ab.addClass(D).children().addClass(d);if(a.inArray(ad,z)===-1){z.push(ad)}}}).delegate(V,L,function(ad){var ac=a(this),ae=ac.attr("id"),ab;if(!U){a(this).removeClass(D).children().removeClass(d);ab=a.inArray(ae,z);if(ab!==-1){z.splice(ab,1)}}}).delegate(V,q,function(){var ac=a(this).removeClass(D).addClass(G),ab=(s?ac:ac.children()).removeClass(d);ac.is("."+h)&&ac.droppable("disable");ab.is("."+Z)&&ab.draggable("disable");!s&&ab.removeClass(G)}).delegate(V,i,function(){var ac=a(this).removeClass(G),ab=s?ac:ac.children();ac.is("."+h)&&ac.droppable("enable");ab.is("."+Z)&&ab.draggable("enable")}).delegate(V,"scrolltoview",function(){K(a(this))}).delegate(V,"hover",function(ab){c.trigger("hover",{hash:a(this).attr("id"),type:ab.type})}).bind("contextmenu."+c.namespace,function(ac){var ab=a(ac.target).closest("."+M);if(ab.length){ac.stopPropagation();ac.preventDefault();if(!ab.is("."+G)){if(!ab.is("."+D)){S();ab.trigger(R);B()}c.trigger("contextmenu",{type:"files",targets:c.selected(),x:ac.clientX,y:ac.clientY})}}}).selectable({filter:V,stop:B,selected:function(ac,ab){a(ab.selected).trigger(R)},unselected:function(ac,ab){a(ab.unselected).trigger(L)}}).droppable(g).bind("create."+c.namespace,function(ae,ab){var ac=s?F.find("tbody"):F,ad=ac.find(".elfinder-cwd-parent"),ab=a(m(ab)).addClass(I);S();if(ad.length){ad.after(ab)}else{ac.prepend(ab)}F.scrollTop(0)}).bind("unselectall",S).bind("selectfile",function(ab,ac){F.find("#"+ac).trigger(R);B()}),r=a('<div class="elfinder-cwd-wrapper"/>').bind("contextmenu",function(ab){ab.preventDefault();c.trigger("contextmenu",{type:"cwd",targets:[c.cwd().hash],x:ab.clientX,y:ab.clientY})}),n=function(){var ab=0;r.siblings(".elfinder-panel:visible").each(function(){ab+=a(this).outerHeight(true)});r.height(T.height()-ab)},j=a(this).parent().resize(n),T=j.children(".elfinder-workzone").append(r.append(this));if(c.dragUpload){r[0].addEventListener("dragenter",function(ab){ab.preventDefault();ab.stopPropagation();r.addClass(v)},false);r[0].addEventListener("dragleave",function(ab){ab.preventDefault();ab.stopPropagation();ab.target==F[0]&&r.removeClass(v)},false);r[0].addEventListener("dragover",function(ab){ab.preventDefault();ab.stopPropagation()},false);r[0].addEventListener("drop",function(ab){ab.preventDefault();r.removeClass(v);ab.dataTransfer&&ab.dataTransfer.files&&ab.dataTransfer.files.length&&c.exec("upload",{files:ab.dataTransfer.files})},false)}c.bind("open",function(ab){k(ab.data.files)}).bind("search",function(ab){t=ab.data.files;k(t,true)}).bind("searchend",function(){t=[];if(Y){Y="";k(c.files())}}).bind("searchstart",function(ab){Y=ab.data.query}).bind("sortchange",function(){k(Y?t:c.files(),!!Y)}).bind("viewchange",function(){var ac=c.selected(),ab=c.storage("view")=="list";if(ab!=s){s=ab;k(c.files());a.each(ac,function(ad,ae){l(ae)});B()}n()}).add(function(ac){var ad=c.cwd().hash,ab=Y?a.map(ac.data.added||[],function(ae){return ae.name.indexOf(Y)===-1?null:ae}):a.map(ac.data.added||[],function(ae){return ae.phash==ad?ae:null});f(ab)}).change(function(ad){var ae=c.cwd().hash,ac=c.selected(),ab;if(Y){a.each(ad.data.changed||[],function(ag,af){w([af.hash]);if(af.name.indexOf(Y)!==-1){f([af]);a.inArray(af.hash,ac)!==-1&&l(af.hash)}})}else{a.each(a.map(ad.data.changed||[],function(af){return af.phash==ae?af:null}),function(ag,af){w([af.hash]);f([af]);a.inArray(af.hash,ac)!==-1&&l(af.hash)})}B()}).remove(function(ab){w(ab.data.removed||[]);B()}).bind("open add search searchend",function(){F.css("height","auto");if(F.outerHeight(true)<r.height()){F.height(r.height()-(F.outerHeight(true)-F.height())-2)}}).dragstart(function(ac){var ab=a(ac.data.target),ad=ac.data.originalEvent;if(ab.is(V)){if(!ab.is("."+D)){!(ad.ctrlKey||ad.metaKey||ad.shiftKey)&&S();ab.trigger(R);B()}F.droppable("disable")}F.selectable("disable").removeClass(G);U=true}).dragstop(function(){F.selectable("enable").droppable("enable");U=false}).bind("lockfiles unlockfiles",function(ae){var ad=ae.type=="lockfiles"?q:i,ac=ae.data.files||[],ab=ac.length;while(ab--){F.find("#"+ac[ab]).trigger(ad)}B()}).bind("mkdir mkfile duplicate upload rename archive extract",function(ac){var ad=c.cwd().hash,ab;S();a.each(ac.data.added||[],function(af,ae){ae&&ae.phash==ad&&l(ae.hash)});B()}).shortcut({pattern:"ctrl+a",description:"selectall",callback:X}).shortcut({pattern:"left right up down shift+left shift+right shift+up shift+down",description:"selectfiles",type:"keydown",callback:function(ab){N(ab.keyCode,ab.shiftKey)}}).shortcut({pattern:"home",description:"selectffile",callback:function(ab){S();K(F.find("[id]:first").trigger(R));B()}}).shortcut({pattern:"end",description:"selectlfile",callback:function(ab){S();K(F.find("[id]:last").trigger(R));B()}})});return this};"use strict";a.fn.elfinderdialog=function(c){var b;if(typeof(c)=="string"&&(b=this.closest(".ui-dialog")).length){if(c=="open"){b.css("display")=="none"&&b.fadeIn(120,function(){b.trigger("open")})}else{if(c=="close"){b.css("display")!="none"&&b.hide().trigger("close")}else{if(c=="destroy"){b.hide().remove()}else{if(c=="toTop"){b.trigger("totop")}}}}}c=a.extend({},a.fn.elfinderdialog.defaults,c);this.filter(":not(.ui-dialog-content)").each(function(){var p=a(this).addClass("ui-dialog-content ui-widget-content"),o=p.parent(),e="elfinder-dialog-active",h="elfinder-dialog",m="elfinder-dialog-notify",g="ui-state-hover",d=parseInt(Math.random()*1000000),f=o.children(".elfinder-overlay"),i=a('<div class="ui-dialog-buttonset"/>'),n=a('<div class=" ui-helper-clearfix ui-dialog-buttonpane ui-widget-content"/>').append(i),j=a('<div class="ui-dialog ui-widget ui-widget-content ui-corner-all ui-draggable std42-dialog  '+h+" "+c.cssClass+'"/>').hide().append(p).appendTo(o).draggable({handle:".ui-dialog-titlebar",containment:"document"}).css({width:c.width,height:c.height}).mousedown(function(q){q.stopPropagation();a(document).mousedown();if(!j.is("."+e)){o.find("."+h+":visible").removeClass(e);j.addClass(e).zIndex(k()+1)}}).bind("open",function(){c.modal&&f.elfinderoverlay("show");j.trigger("totop");typeof(c.open)=="function"&&a.proxy(c.open,p[0])();if(!j.is("."+m)){o.find("."+h+":visible").not("."+m).each(function(){var u=a(this),s=parseInt(u.css("top")),r=parseInt(u.css("left")),t=parseInt(j.css("top")),q=parseInt(j.css("left"));if(u[0]!=j[0]&&(s==t||r==q)){j.css({top:(s+10)+"px",left:(r+10)+"px"})}})}}).bind("close",function(){var q=o.find(".elfinder-dialog:visible"),r=k();c.modal&&f.elfinderoverlay("hide");if(q.length){q.each(function(){var s=a(this);if(s.zIndex()>=r){s.trigger("totop");return false}})}else{setTimeout(function(){o.mousedown().click()},10)}if(typeof(c.close)=="function"){a.proxy(c.close,p[0])()}else{if(c.destroyOnClose){j.hide().remove()}}}).bind("totop",function(){a(this).mousedown().find(".ui-button:first").focus().end().find(":text:first").focus()}),k=function(){var q=o.zIndex()+10;o.find("."+h+":visible").each(function(){var r;if(this!=j[0]){r=a(this).zIndex();if(r>q){q=r}}});return q},l;if(!c.position){l=parseInt((o.height()-j.outerHeight())/2-42);c.position={top:(l>0?l:0)+"px",left:parseInt((o.width()-j.outerWidth())/2)+"px"}}j.css(c.position);if(c.closeOnEscape){a(document).bind("keyup."+d,function(q){if(q.keyCode==a.ui.keyCode.ESCAPE&&j.is("."+e)){p.elfinderdialog("close");a(document).unbind("keyup."+d)}})}j.prepend(a('<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">'+c.title+"</div>").prepend(a('<a href="#" class="ui-dialog-titlebar-close ui-corner-all"><span class="ui-icon ui-icon-closethick"/></a>').mousedown(function(q){q.preventDefault();p.elfinderdialog("close")})));a.each(c.buttons,function(r,q){var s=a('<button type="button" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"><span class="ui-button-text">'+r+"</span></button>").click(a.proxy(q,p[0])).hover(function(t){a(this)[t.type=="mouseenter"?"focus":"blur"]()}).focus(function(){a(this).addClass(g)}).blur(function(){a(this).removeClass(g)}).keydown(function(u){var t;if(u.keyCode==a.ui.keyCode.ENTER){a(this).click()}else{if(u.keyCode==a.ui.keyCode.TAB){t=a(this).next(".ui-button");t.length?t.focus():a(this).parent().children(".ui-button:first").focus()}}});i.append(s)});i.children().length&&j.append(n);if(c.resizable&&a.fn.resizable){j.resizable({minWidth:c.minWidth,minHeight:c.minHeight,alsoResize:this})}typeof(c.create)=="function"&&a.proxy(c.create,this)();c.autoOpen&&p.elfinderdialog("open")});return this};a.fn.elfinderdialog.defaults={cssClass:"",title:"",modal:false,resizable:true,autoOpen:true,closeOnEscape:true,destroyOnClose:false,buttons:{},position:null,width:320,height:"auto",minWidth:200,minHeight:110};a.fn.elfindernavbar=function(c,b){this.not(".elfinder-navbar").each(function(){var h=a(this).addClass("ui-state-default elfinder-navbar"),f=h.parent().resize(function(){h.height(e.height()-i)}),e=f.children(".elfinder-workzone").append(h),i=h.outerHeight()-h.height(),d=c.direction=="ltr",g;if(a.fn.resizable){g=h.resizable({handles:d?"e":"w",minWidth:b.minWidth||150,maxWidth:b.maxWidth||500}).bind("resize scroll",function(){g.css({top:parseInt(h.scrollTop())+"px",left:parseInt(d?h.width()+h.scrollLeft()-g.width()-2:h.scrollLeft()+2)})}).find(".ui-resizable-handle").zIndex(h.zIndex()+10);if(!d){h.resize(function(){h.css("left",null).css("right",0)})}c.one("open",function(){setTimeout(function(){h.trigger("resize")},150)})}});return this};a.fn.elfinderoverlay=function(e){this.filter(":not(.elfinder-overlay)").each(function(){e=a.extend({},e);a(this).addClass("ui-widget-overlay elfinder-overlay").hide().mousedown(function(g){g.preventDefault();g.stopPropagation()}).data({cnt:0,show:typeof(e.show)=="function"?e.show:function(){},hide:typeof(e.hide)=="function"?e.hide:function(){}})});if(e=="show"){var f=this.eq(0),d=f.data("cnt")+1,b=f.data("show");f.data("cnt",d);if(f.is(":hidden")){f.zIndex(f.parent().zIndex()+1);f.show();b()}}if(e=="hide"){var f=this.eq(0),d=f.data("cnt")-1,c=f.data("hide");f.data("cnt",d);if(d==0&&f.is(":visible")){f.hide();c()}}return this};a.fn.elfinderpanel=function(b){return this.each(function(){var c=a(this).addClass("elfinder-panel ui-state-default ui-corner-all"),d="margin-"+(b.direction=="ltr"?"left":"right");b.one("load",function(g){var f=b.getUI("navbar");c.css(d,parseInt(f.outerWidth(true)));f.bind("resize",function(){c.is(":visible")&&c.css(d,parseInt(f.outerWidth(true)))})})})};"use strict";a.fn.elfinderpath=function(b){return this.each(function(){var c=a(this).addClass("elfinder-path").html("&nbsp;").delegate("a","click",function(f){var d=a(this).attr("href").substr(1);f.preventDefault();d!=b.cwd().hash&&b.exec("open",d)}).prependTo(b.getUI("statusbar").show());b.bind("open searchend",function(){var d=[];a.each(b.parents(b.cwd().hash),function(e,f){d.push('<a href="#'+f+'">'+b.escape(b.file(f).name)+"</a>")});c.html(d.join(b.option("separator")))}).bind("search",function(){c.html(b.i18n("searcresult"))})})};"use strict";a.fn.elfinderplaces=function(c,b){return this.each(function(){var g=[],s="class",l=c.res(s,"navdir"),d=c.res(s,"navcollapse"),q=c.res(s,"navexpand"),u=c.res(s,"hover"),i=c.res(s,"treeroot"),x=c.res("tpl","navdir"),o=c.res("tpl","perms"),f=a(c.res("tpl","navspinner")),t=function(y){return y.substr(6)},h=function(y){return"place-"+y},r=function(){c.storage("places",g.join(","))},j=function(y){return a(x.replace(/\{id\}/,h(y.hash)).replace(/\{name\}/,c.escape(y.name)).replace(/\{cssclass\}/,c.perms2class(y)).replace(/\{permissions\}/,!y.read||!y.write?o:"").replace(/\{symlink\}/,""))},m=function(y){var z=j(y);if(v.children().length){a.each(v.children(),function(){var A=a(this);if(y.name.localeCompare(A.children("."+l).text())<0){return !z.insertBefore(A)}})}g.push(y.hash);!z.parent().length&&v.append(z);p.addClass(d);z.draggable({appendTo:"body",revert:false,helper:function(){var A=a(this);A.children().removeClass("ui-state-hover");return a('<div class="elfinder-place-drag elfinder-'+c.direction+'"/>').append(A.clone()).data("hash",t(A.children(":first").attr("id")))},start:function(){a(this).hide()},stop:function(G,D){var F=k.offset().top,E=k.offset().left,C=k.width(),B=k.height(),A=G.clientX,H=G.clientY;if(A>E&&A<E+C&&H>F&&H<H+B){a(this).show()}else{w(D.helper.data("hash"));r()}}})},w=function(z){var y=a.inArray(z,g);if(y!==-1){g.splice(y,1);v.find("#"+h(z)).parent().remove();!v.children().length&&p.removeClass(d+" "+q)}},n=function(){v.empty();p.removeClass(d+" "+q)},e=j({hash:"root-"+c.namespace,name:c.i18n(b.name,"places"),read:true,write:true}),p=e.children("."+l).addClass(i).click(function(){if(p.is("."+d)){k.toggleClass(q);v.slideToggle();c.storage("placesState",k.is("."+q)?1:0)}}),v=e.children("."+c.res(s,"navsubtree")),k=a(this).addClass(c.res(s,"tree")+" elfinder-places ui-corner-all").hide().append(e).appendTo(c.getUI("navbar")).delegate("."+l,"hover",function(){a(this).toggleClass("ui-state-hover")}).delegate("."+l,"click",function(y){c.exec("open",a(this).attr("id").substr(6))}).delegate("."+l+":not(."+i+")","contextmenu",function(z){var y=a(this).attr("id").substr(6);z.preventDefault();c.trigger("contextmenu",{raw:[{label:c.i18n("rmFromPlaces"),icon:"rm",callback:function(){w(y);r()}}],x:z.clientX,y:z.clientY})}).droppable({tolerance:"pointer",accept:".elfinder-cwd-file-wrapper,.elfinder-tree-dir,.elfinder-cwd-file",hoverClass:c.res("class","adroppable"),drop:function(A,z){var y=true;a.each(z.helper.data("files"),function(C,D){var B=c.file(D);if(B&&B.mime=="directory"&&a.inArray(B.hash,g)===-1){m(B)}else{y=false}});r();y&&z.helper.hide()}});c.one("load",function(){if(c.oldAPI){return}k.show().parent().show();g=a.map(c.storage("places").split(","),function(y){return y||null});if(g.length){p.prepend(f);c.request({data:{cmd:"info",targets:g},preventDefault:true}).done(function(y){g=[];a.each(y.files,function(A,z){z.mime=="directory"&&m(z)});r();if(c.storage("placesState")>0){p.click()}}).always(function(){f.remove()})}c.remove(function(y){a.each(y.data.removed,function(z,A){w(A)});r()}).change(function(y){a.each(y.data.changed,function(A,z){if(a.inArray(z.hash,g)!==-1){w(z.hash);z.mime=="directory"&&m(z)}});r()}).bind("sync",function(){if(g.length){p.prepend(f);c.request({data:{cmd:"info",targets:g},preventDefault:true}).done(function(y){a.each(y.files||[],function(A,z){if(a.inArray(z.hash,g)===-1){w(z.hash)}});r()}).always(function(){f.remove()})}})})})};"use strict";a.fn.elfindersearchbutton=function(b){return this.each(function(){var c=false,f=a(this).hide().addClass("ui-widget-content elfinder-button "+b.fm.res("class","searchbtn")+""),e=function(){var h=a.trim(d.val());if(h){b.exec(h).done(function(){c=true;d.focus()})}else{b.fm.trigger("searchend")}},g=function(){d.val("");if(c){c=false;b.fm.trigger("searchend")}},d=a('<input type="text" size="42"/>').appendTo(f).keypress(function(h){h.stopPropagation()}).keydown(function(h){h.stopPropagation();h.keyCode==13&&e();if(h.keyCode==27){h.preventDefault();g()}});a('<span class="ui-icon ui-icon-search" title="'+b.title+'"/>').appendTo(f).click(e);a('<span class="ui-icon ui-icon-close"/>').appendTo(f).click(g);setTimeout(function(){f.parent().detach();b.fm.getUI("toolbar").prepend(f.show());if(b.fm.UA.ltIE7){var h=f.children(b.fm.direction=="ltr"?".ui-icon-close":".ui-icon-search");h.css({right:"",left:parseInt(f.width())-h.outerWidth(true)})}},200);b.fm.error(function(){d.unbind("keydown")}).select(function(){d.blur()}).bind("searchend",function(){d.val("")}).viewchange(g).shortcut({pattern:"ctrl+f f3",description:b.title,callback:function(){d.select().focus()}})})};"use strict";a.fn.elfindersortbutton=function(b){return this.each(function(){var n=b.fm,d=b.name,m="class",g=n.res(m,"disabled"),l=n.res(m,"hover"),p="elfinder-button-menu-item",h=p+"-selected",o=h+"-asc",k=h+"-desc",i=a(this).addClass("ui-state-default elfinder-button elfinder-menubutton elfiner-button-"+d).attr("title",b.title).append('<span class="elfinder-button-icon elfinder-button-icon-'+d+'"/>').hover(function(c){!i.is("."+g)&&i.toggleClass(l)}).click(function(c){if(!i.is("."+g)){c.stopPropagation();e.is(":hidden")&&b.fm.getUI().click();e.slideToggle(100)}}),e=a('<div class="ui-widget ui-widget-content elfinder-button-menu ui-corner-all"/>').hide().appendTo(i).zIndex(12+i.zIndex()).delegate("."+p,"hover",function(){a(this).toggleClass(l)}).delegate("."+p,"click",function(c){c.preventDefault();c.stopPropagation();j()}),f=function(){e.children(":not(:last)").removeClass(h+" "+o+" "+k).filter('[rel="'+n.sortType+'"]').addClass(h+" "+(n.sortOrder=="asc"?o:k));e.children(":last").toggleClass(h,n.sortStickFolders)},j=function(){e.hide()};a.each(n.sortRules,function(c,q){e.append(a('<div class="'+p+'" rel="'+c+'"><span class="ui-icon ui-icon-arrowthick-1-n"/><span class="ui-icon ui-icon-arrowthick-1-s"/>'+n.i18n("sort"+c)+"</div>").data("type",c))});e.children().click(function(q){var c=a(this).attr("rel");b.exec([],{type:c,order:c==n.sortType?n.sortOrder=="asc"?"desc":"asc":n.sortOrder,stick:n.sortStickFolders})});a('<div class="'+p+" "+p+'-separated"><span class="ui-icon ui-icon-check"/>'+n.i18n("sortFoldersFirst")+"</div>").appendTo(e).click(function(){b.exec([],{type:n.sortType,order:n.sortOrder,stick:!n.sortStickFolders})});n.bind("disable select",j).getUI().click(j);n.bind("sortchange",f);if(e.children().length>1){b.change(function(){i.toggleClass(g,b.disabled());f()}).change()}else{i.addClass(g)}})};"use strict";a.fn.elfinderstat=function(b){return this.each(function(){var e=a(this).addClass("elfinder-stat-size"),f=a('<div class="elfinder-stat-selected"/>'),h=b.i18n("size").toLowerCase(),c=b.i18n("items").toLowerCase(),g=b.i18n("selected"),d=function(k,j){var l=0,i=0;a.each(k,function(n,m){if(!j||m.phash==j){l++;i+=parseInt(m.size)||0}});e.html(c+": "+l+", "+h+": "+b.formatSize(i))};b.getUI("statusbar").prepend(e).append(f).show();b.bind("open reload add remove change searchend",function(){d(b.files(),b.cwd().hash)}).search(function(i){d(i.data.files)}).select(function(){var i=0,k=0,j=b.selectedFiles();if(j.length==1){i=j[0].size;f.html(b.escape(j[0].name)+(i>0?", "+b.formatSize(i):""));return}a.each(j,function(m,l){k++;i+=parseInt(l.size)||0});f.html(k?g+": "+k+", "+h+": "+b.formatSize(i):"&nbsp;")})})};"use strict";a.fn.elfindertoolbar=function(c,b){this.not(".elfinder-toolbar").each(function(){var d=c._commands,g=a(this).addClass("ui-helper-clearfix ui-widget-header ui-corner-top elfinder-toolbar"),h=b||[],f=h.length,k,m,e,j;g.prev().length&&g.parent().prepend(this);while(f--){if(h[f]){e=a('<div class="ui-widget-content ui-corner-all elfinder-buttonset"/>');k=h[f].length;while(k--){if((m=d[h[f][k]])){j="elfinder"+m.options.ui;a.fn[j]&&e.prepend(a("<div/>")[j](m))}}e.children().length&&g.prepend(e);e.children(":gt(0)").before('<span class="ui-widget-content elfinder-toolbar-button-separator"/>')}}g.children().length&&g.show()});return this};"use strict";a.fn.elfindertree=function(d,c){var b=d.res("class","tree");this.not("."+b).each(function(){var G="class",x=d.res(G,"treeroot"),E=c.openRootOnLoad,I=d.res(G,"navsubtree"),u=d.res(G,"treedir"),m=d.res(G,"navcollapse"),z=d.res(G,"navexpand"),A="elfinder-subtree-loaded",j=d.res(G,"navarrow"),o=d.res(G,"active"),g=d.res(G,"adroppable"),H=d.res(G,"hover"),l=d.res(G,"disabled"),k=d.res(G,"draggable"),K=d.res(G,"droppable"),B=function(L){var M=y.offset().left;return M<=L&&L<=M+y.width()},p=d.droppable.drop,s=a.extend(true,{},d.droppable,{over:function(N){var M=a(this),L=H+" "+g;if(B(N.clientX)){M.addClass(L);if(M.is("."+m+":not(."+z+")")){setTimeout(function(){M.is("."+g)&&M.children("."+j).click()},500)}}else{M.removeClass(L)}},out:function(){a(this).removeClass(H+" "+g)},drop:function(M,L){B(M.clientX)&&p.call(this,M,L)}}),n=a(d.res("tpl","navspinner")),J=d.res("tpl","navdir"),w=d.res("tpl","perms"),i=d.res("tpl","symlink"),F={id:function(L){return d.navHash2Id(L.hash)},cssclass:function(L){return(L.phash?"":x)+" "+u+" "+d.perms2class(L)+" "+(L.dirs&&!L.link?m:"")},permissions:function(L){return !L.read||!L.write?w:""},symlink:function(L){return L.alias?i:""}},e=function(L){L.name=d.escape(L.i18||L.name);return J.replace(/(?:\{([a-z]+)\})/ig,function(M,N){return L[N]||(F[N]?F[N](L):"")})},r=function(L){return a.map(L||[],function(M){return M.mime=="directory"?M:null})},t=function(L){return L?v.find("#"+d.navHash2Id(L)).next("."+I):v},D=function(N,L){var M=N.children(":first"),O;while(M.length){O=d.file(d.navId2Hash(M.children("[id]").attr("id")));if((O=d.file(d.navId2Hash(M.children("[id]").attr("id"))))&&L.name.toLowerCase().localeCompare(O.name.toLowerCase())<0){return M}M=M.next()}return a("")},C=function(S){var R=S.length,M=[],O=S.length,L,N,Q,P;while(O--){L=S[O];if(v.find("#"+d.navHash2Id(L.hash)).length){continue}if((Q=t(L.phash)).length){N=e(L);if(L.phash&&(P=D(Q,L)).length){P.before(N)}else{Q[L.phash?"append":"prepend"](N)}}else{M.push(L)}}if(M.length&&M.length<R){return C(M)}setTimeout(function(){h()},10)},q=function(P){var N=d.cwd().hash,O=v.find("#"+d.navHash2Id(N)),L,M;if(E){L=v.find("#"+d.navHash2Id(d.root()));L.is("."+A)&&L.addClass(z).next("."+I).show();E=false}if(!O.is("."+o)){v.find("."+u+"."+o).removeClass(o);O.addClass(o)}if(c.syncTree){if(O.length){return O.parentsUntil("."+x).filter("."+I).show().prev("."+u).addClass(z)}if(d.newAPI){M=d.file(N);if(M&&M.phash&&v.find("#"+d.navHash2Id(M.phash)).length){C([M]);return q()}d.request({data:{cmd:"parents",target:N},preventFail:true}).done(function(Q){var R=r(Q.tree);C(R);f(R,A);N==d.cwd().hash&&q(true)})}}},h=function(){v.find("."+u+":not(."+K+",.elfinder-ro,.elfinder-na)").droppable(s)},f=function(N,L){var M=L==A?"."+m+":not(."+A+")":":not(."+m+")";a.each(N,function(P,O){v.find("#"+d.navHash2Id(O.phash)+M).filter(function(){return a(this).next("."+I).children().length>0}).addClass(L)})},v=a(this).addClass(b).delegate("."+u,"hover",function(M){var L=a(this),N=M.type=="mouseenter";if(!L.is("."+g+" ,."+l)){N&&!L.is("."+x+",."+k+",.elfinder-na,.elfinder-wo")&&L.draggable(d.draggable);L.toggleClass(H,N)}}).delegate("."+u,"dropover dropout drop",function(L){a(this)[L.type=="dropover"?"addClass":"removeClass"](g+" "+H)}).delegate("."+u,"click",function(O){var M=a(this),N=d.navId2Hash(M.attr("id")),L=d.file(N);d.trigger("searchend");if(N!=d.cwd().hash&&!M.is("."+l)){d.exec("open",L.thash||N)}else{if(M.is("."+m)){M.children("."+j).click()}}}).delegate("."+u+"."+m+" ."+j,"click",function(O){var M=a(this),L=M.parent("."+u),N=L.next("."+I);O.stopPropagation();if(L.is("."+A)){L.toggleClass(z);N.slideToggle()}else{n.insertBefore(M);L.removeClass(m);d.request({cmd:"tree",target:d.navId2Hash(L.attr("id"))}).done(function(P){C(r(P.tree));if(N.children().length){L.addClass(m+" "+z);N.slideDown()}q()}).always(function(P){n.remove();L.addClass(A)})}}).delegate("."+u,"contextmenu",function(L){L.preventDefault();d.trigger("contextmenu",{type:"navbar",targets:[d.navId2Hash(a(this).attr("id"))],x:L.clientX,y:L.clientY})}),y=d.getUI("navbar").append(v).show();d.open(function(N){var L=N.data,M=r(L.files);L.init&&v.empty();if(M.length){C(M);f(M,A)}q()}).add(function(M){var L=r(M.data.added);if(L.length){C(L);f(L,m)}}).change(function(T){var N=r(T.data.changed),Q=N.length,P,O,S,U,R,V,W,M,L;while(Q--){P=N[Q];if((O=v.find("#"+d.navHash2Id(P.hash))).length){if(P.phash){U=O.closest("."+I);R=t(P.phash);V=O.parent().next();W=D(R,P);if(!R.length){continue}if(R[0]!==U[0]||V.get(0)!==W.get(0)){W.length?W.before(O):R.append(O)}}M=O.is("."+z);L=O.is("."+A);S=a(e(P));O.replaceWith(S.children("."+u));if(P.dirs&&(M||L)&&(O=v.find("#"+d.navHash2Id(P.hash)))&&O.next("."+I).children().length){M&&O.addClass(z);L&&O.addClass(A)}}}q();h()}).remove(function(P){var O=P.data.removed,L=O.length,M,N;while(L--){if((M=v.find("#"+d.navHash2Id(O[L]))).length){N=M.closest("."+I);M.parent().detach();if(!N.children().length){N.hide().prev("."+u).removeClass(m+" "+z+" "+A)}}}}).bind("search searchend",function(L){v.find("#"+d.navHash2Id(d.cwd().hash))[L.type=="search"?"removeClass":"addClass"](o)}).bind("lockfiles unlockfiles",function(O){var M=O.type=="lockfiles",L=M?"disable":"enable",N=a.map(O.data.files||[],function(Q){var P=d.file(Q);return P&&P.mime=="directory"?Q:null});a.each(N,function(Q,R){var P=v.find("#"+d.navHash2Id(R));if(P.length){P.is("."+k)&&P.draggable(L);P.is("."+K)&&P.droppable(o);P[M?"addClass":"removeClass"](l)}})})});return this};"use strict";a.fn.elfinderuploadbutton=function(b){return this.each(function(){var d=a(this).elfinderbutton(b).unbind("click"),e=a("<form/>").appendTo(d),c=a('<input type="file" multiple="true"/>').change(function(){var f=a(this);if(f.val()){b.exec({input:f.remove()[0]});c.clone(true).appendTo(e)}});e.append(c.clone(true));b.change(function(){e[b.disabled()?"hide":"show"]()}).change()})};"use strict";a.fn.elfinderviewbutton=function(b){return this.each(function(){var c=a(this).elfinderbutton(b),d=c.children(".elfinder-button-icon");b.change(function(){var e=b.value=="icons";d.toggleClass("elfinder-button-icon-view-list",e);c.attr("title",b.fm.i18n(e?"viewlist":"viewicons"))})})};"use strict";a.fn.elfinderworkzone=function(c){var b="elfinder-workzone";this.not("."+b).each(function(){var f=a(this).addClass(b),d=f.outerHeight(true)-f.height(),e=f.parent();e.add(window).bind("resize",function(){var g=e.height();e.children(":visible:not(."+b+")").each(function(){var h=a(this);if(h.css("position")!="absolute"){g-=h.outerHeight(true)}});f.height(g-d)})});return this};"use strict";elFinder.prototype.commands.archive=function(){var c=this,d=c.fm,b=[];this.variants=[];this.disableOnSearch=true;d.bind("open reload",function(){c.variants=[];a.each((b=d.option("archivers")["create"]||[]),function(e,f){c.variants.push([f,d.mime2kind(f)])});c.change()});this.getstate=function(){return !this._disabled&&b.length&&d.selected().length&&d.cwd().write?0:-1};this.exec=function(n,k){var f=this.files(n),h=f.length,e=k||b[0],m=d.cwd(),l=["errArchive","errPerm","errCreatingTempDir","errFtpDownloadFile","errFtpUploadFile","errFtpMkdir","errArchiveExec","errExtractExec","errRm"],g=a.Deferred().fail(function(i){i&&d.error(i)}),j;if(!(this.enabled()&&h&&b.length&&a.inArray(e,b)!==-1)){return g.reject()}if(!m.write){return g.reject(l)}for(j=0;j<h;j++){if(!f[j].read){return g.reject(l)}}return d.request({data:{cmd:"archive",targets:this.hashes(n),type:e},notify:{type:"archive",cnt:1},syncOnFail:true})}};"use strict";elFinder.prototype.commands.back=function(){this.alwaysEnabled=true;this.updateOnSelect=false;this.shortcuts=[{pattern:"ctrl+left backspace"}];this.getstate=function(){return this.fm.history.canBack()?0:-1};this.exec=function(){return this.fm.history.back()}};"use strict";elFinder.prototype.commands.copy=function(){this.shortcuts=[{pattern:"ctrl+c ctrl+insert"}];this.getstate=function(c){var c=this.files(c),b=c.length;return b&&a.map(c,function(d){return d.phash&&d.read?d:null}).length==b?0:-1};this.exec=function(c){var d=this.fm,b=a.Deferred().fail(function(e){d.error(e)});a.each(this.files(c),function(f,e){if(!(e.read&&e.phash)){return !b.reject(["errCopy",e.name,"errPerm"])}});return b.state()=="rejected"?b:b.resolve(d.clipboard(this.hashes(c)))}};"use strict";elFinder.prototype.commands.cut=function(){this.shortcuts=[{pattern:"ctrl+x shift+insert"}];this.getstate=function(c){var c=this.files(c),b=c.length;return b&&a.map(c,function(d){return d.phash&&d.read&&!d.locked?d:null}).length==b?0:-1};this.exec=function(c){var d=this.fm,b=a.Deferred().fail(function(e){d.error(e)});a.each(this.files(c),function(f,e){if(!(e.read&&e.phash)){return !b.reject(["errCopy",e.name,"errPerm"])}if(e.locked){return !b.reject(["errLocked",e.name])}});return b.state()=="rejected"?b:b.resolve(d.clipboard(this.hashes(c),true))}};"use strict";elFinder.prototype.commands.download=function(){var b=this,d=this.fm,c=function(e){return a.map(b.files(e),function(g){return g.mime=="directory"?null:g})};this.shortcuts=[{pattern:"shift+enter"}];this.getstate=function(){var f=this.fm.selected(),e=f.length;return !this._disabled&&e&&(!d.UA.IE||e==1)&&e==c(f).length?0:-1};this.exec=function(n){var l=this.fm,h=l.options.url,f=c(n),g=a.Deferred(),k="",m="",j,e;if(this.disabled()){return g.reject()}if(l.oldAPI){l.error("errCmdNoSupport");return g.reject()}a.each(l.options.customData||{},function(o,i){m+="&"+o+"="+i});h+=h.indexOf("?")===-1?"?":"&";for(j=0;j<f.length;j++){k+='<iframe class="downloader" id="downloader-'+f[j].hash+'" style="display:none" src="'+h+"cmd=file&target="+f[j].hash+"&download=1"+m+'"/>'}a(k).appendTo("body").ready(function(){setTimeout(function(){a(k).each(function(){a("#"+a(this).attr("id")).remove()})},l.UA.Firefox?(20000+(10000*j)):1000)});l.trigger("download",{files:f});return g.resolve(n)}};"use strict";elFinder.prototype.commands.duplicate=function(){var b=this.fm;this.getstate=function(d){var d=this.files(d),c=d.length;return !this._disabled&&c&&b.cwd().write&&a.map(d,function(e){return e.phash&&e.read?e:null}).length==c?0:-1};this.exec=function(e){var h=this.fm,g=this.files(e),f=g.length,c=a.Deferred().fail(function(i){i&&h.error(i)}),d=[];if(!f||this._disabled){return c.reject()}a.each(g,function(k,j){if(!j.read||!h.file(j.phash).write){return !c.reject(["errCopy",j.name,"errPerm"])}});if(c.state()=="rejected"){return c}return h.request({data:{cmd:"duplicate",targets:this.hashes(e)},notify:{type:"copy",cnt:f}})}};"use strict";elFinder.prototype.commands.edit=function(){var c=this,g=this.fm,b=g.res("mimes","text")||[],e=function(h){return a.map(h,function(i){return(i.mime.indexOf("text/")===0||a.inArray(i.mime,b)!==-1)&&i.mime.indexOf("text/rtf")&&(!c.onlyMimes.length||a.inArray(i.mime,c.onlyMimes)!==-1)&&i.read&&i.write?i:null})},d=function(o,j,n){var i=a.Deferred(),h=a('<textarea class="elfinder-file-edit" rows="20" id="'+o+'-ta">'+g.escape(n)+"</textarea>"),m=function(){h.editor&&h.editor.save(h[0],h.editor.instance);i.resolve(h.getContent());h.elfinderdialog("close")},l=function(){i.reject();h.elfinderdialog("close")},k={title:j.name,width:c.options.dialogWidth||450,buttons:{},close:function(){h.editor&&h.editor.close(h[0],h.editor.instance);a(this).elfinderdialog("destroy")},open:function(){g.disable();h.focus();h[0].setSelectionRange&&h[0].setSelectionRange(0,0);h.editor&&h.editor.load(h[0])}};h.getContent=function(){return h.val()};a.each(c.options.editors||[],function(p,q){if(a.inArray(j.mime,q.mimes||[])!==-1&&typeof q.load=="function"&&typeof q.save=="function"){h.editor={load:q.load,save:q.save,close:typeof q.close=="function"?q.close:function(){},instance:null};return false}});if(!h.editor){h.keydown(function(r){var p=r.keyCode,q,s;r.stopPropagation();if(p==9){r.preventDefault();if(this.setSelectionRange){q=this.value;s=this.selectionStart;this.value=q.substr(0,s)+"\t"+q.substr(this.selectionEnd);s+=1;this.setSelectionRange(s,s)}}if(r.ctrlKey||r.metaKey){if(p==81||p==87){r.preventDefault();l()}if(p==83){r.preventDefault();m()}}})}k.buttons[g.i18n("Save")]=m;k.buttons[g.i18n("Cancel")]=l;g.dialog(h,k).attr("id",o);return i.promise()},f=function(l){var m=l.hash,h=g.options,j=a.Deferred(),n={cmd:"file",target:m},i=g.url(m)||g.options.url,k="edit-"+g.namespace+"-"+l.hash,o=g.getUI().find("#"+k),p;if(o.length){o.elfinderdialog("toTop");return j.resolve()}if(!l.read||!l.write){p=["errOpen",l.name,"errPerm"];g.error(p);return j.reject(p)}g.request({data:{cmd:"get",target:m},notify:{type:"openfile",cnt:1},syncOnFail:true}).done(function(q){d(k,l,q.content).done(function(r){g.request({options:{type:"post"},data:{cmd:"put",target:m,content:r},notify:{type:"save",cnt:1},syncOnFail:true}).fail(function(s){j.reject(s)}).done(function(s){s.changed&&s.changed.length&&g.change(s);j.resolve(s)})})}).fail(function(q){j.reject(q)});return j.promise()};this.shortcuts=[{pattern:"ctrl+e"}];this.init=function(){this.onlyMimes=this.options.mimes||[]};this.getstate=function(i){var i=this.files(i),h=i.length;return !this._disabled&&h&&e(i).length==h?0:-1};this.exec=function(h){var j=e(this.files(h)),k=[],i;if(this.disabled()){return a.Deferred().reject()}while((i=j.shift())){k.push(f(i))}return k.length?a.when.apply(null,k):a.Deferred().reject()}};"use strict";elFinder.prototype.commands.extract=function(){var c=this,e=c.fm,b=[],d=function(f){return a.map(f,function(g){return g.read&&a.inArray(g.mime,b)!==-1?g:null})};this.disableOnSearch=true;e.bind("open reload",function(){b=e.option("archivers")["extract"]||[];c.change()});this.getstate=function(g){var g=this.files(g),f=g.length;return !this._disabled&&f&&this.fm.cwd().write&&d(g).length==f?0:-1};this.exec=function(t){var j=this.files(t),k=a.Deferred(),m=j.length,o,r,p;var n=false;var l=false;var q=a.map(e.files(t),function(i){return i.name});var h={};a.map(e.files(t),function(i){h[i.name]=i});var s=function(i){switch(i){case"overwrite_all":n=true;break;case"omit_all":l=true;break}};var g=function(i){if(!(i.read&&e.file(i.phash).write)){r=["errExtract",i.name,"errPerm"];e.error(r);k.reject(r)}else{if(a.inArray(i.mime,b)===-1){r=["errExtract",i.name,"errNoArchive"];e.error(r);k.reject(r)}else{e.request({data:{cmd:"extract",target:i.hash},notify:{type:"extract",cnt:1},syncOnFail:true}).fail(function(u){if(!k.isRejected()){k.reject(u)}}).done(function(){})}}};var f=function(x,v){var w=x[v];var u=w.name.replace(/\.((tar\.(gz|bz|bz2|z|lzo))|cpio\.gz|ps\.gz|xcf\.(gz|bz2)|[a-z0-9]{1,4})$/ig,"");var i=(a.inArray(u,q)>=0);if(i&&h[u].mime!="directory"){e.confirm({title:e.i18n("ntfextract"),text:e.i18n(["errExists",u,"confirmRepl"]),accept:{label:"btnYes",callback:function(y){p=y?"overwrite_all":"overwrite";s(p);if(!n&&!l){if("overwrite"==p){g(w)}if((v+1)<m){f(x,v+1)}else{k.resolve()}}else{if(n){for(o=0;o<m;o++){g(x[o])}k.resolve()}}}},reject:{label:"btnNo",callback:function(y){p=y?"omit_all":"omit";s(p);if(!n&&!l&&(v+1)<m){f(x,v+1)}else{if(l){k.resolve()}}}},cancel:{label:"btnCancel",callback:function(){k.resolve()}},all:(m>1)})}else{g(w);if((v+1)<m){f(x,v+1)}else{k.resolve()}}};if(!(this.enabled()&&m&&b.length)){return k.reject()}if(m>0){f(j,0)}return k}};elFinder.prototype.commands.forward=function(){this.alwaysEnabled=true;this.updateOnSelect=true;this.shortcuts=[{pattern:"ctrl+right"}];this.getstate=function(){return this.fm.history.canForward()?0:-1};this.exec=function(){return this.fm.history.forward()}};"use strict";elFinder.prototype.commands.getfile=function(){var b=this,d=this.fm,c=function(e){var f=b.options;e=a.map(e,function(g){return g.mime!="directory"||f.folders?g:null});return f.multiple||e.length==1?e:[]};this.alwaysEnabled=true;this.callback=d.options.getFileCallback;this._disabled=typeof(this.callback)=="function";this.getstate=function(f){var f=this.files(f),e=f.length;return this.callback&&e&&c(f).length==e?0:-1};this.exec=function(q){var p=this.fm,f=this.options,g=this.files(q),k=g.length,h=p.option("url"),e=p.option("tmbUrl"),j=a.Deferred().done(function(i){p.trigger("getfile",{files:i});b.callback(i,p);if(f.oncomplete=="close"){p.hide()}else{if(f.oncomplete=="destroy"){p.destroy()}}}),r=function(i){return f.onlyURL?f.multiple?a.map(g,function(s){return s.url}):g[0].url:f.multiple?g:g[0]},o=[],m,l,n;if(this.getstate()==-1){return j.reject()}for(m=0;m<k;m++){l=g[m];if(l.mime=="directory"&&!f.folders){return j.reject()}l.baseUrl=h;l.url=p.url(l.hash);l.path=p.path(l.hash);if(l.tmb&&l.tmb!=1){l.tmb=e+l.tmb}if(!l.width&&!l.height){if(l.dim){n=l.dim.split("x");l.width=n[0];l.height=n[1]}else{if(l.mime.indexOf("image")!==-1){o.push(p.request({data:{cmd:"dim",target:l.hash},preventDefault:true}).done(a.proxy(function(i){if(i.dim){n=i.dim.split("x");this.width=n[0];this.height=n[1]}this.dim=i.dim},g[m])))}}}}if(o.length){a.when.apply(null,o).always(function(){j.resolve(r(g))});return j}return j.resolve(r(g))}};"use strict";elFinder.prototype.commands.help=function(){var k=this.fm,o=this,d='<div class="elfinder-help-link"> <a href="{url}">{link}</a></div>',w='<div class="elfinder-help-link"> <a href="{url}" target="_blank">{link}</a></div>',l='<div class="elfinder-help-team"><div>{author}</div>{work}</div>',h=/\{url\}/,i=/\{link\}/,f=/\{author\}/,s=/\{work\}/,n="replace",e="ui-priority-primary",v="ui-priority-secondary",j="elfinder-help-license",b='<li class="ui-state-default ui-corner-top"><a href="#{id}">{title}</a></li>',m=['<div class="ui-tabs ui-widget ui-widget-content ui-corner-all elfinder-help">','<ul class="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all">'],c='<div class="elfinder-help-shortcut"><div class="elfinder-help-shortcut-pattern">{pattern}</div> {descrip}</div>',p='<div class="elfinder-help-separator"/>',g=function(){m.push('<div id="about" class="ui-tabs-panel ui-widget-content ui-corner-bottom"><div class="elfinder-help-logo"/>');m.push("<h3>elFinder</h3>");m.push('<div class="'+e+'">'+k.i18n("webfm")+"</div>");m.push('<div class="'+v+'">'+k.i18n("ver")+": "+k.version+", "+k.i18n("protocolver")+': <span id="apiver"></span></div>');m.push('<div class="'+v+'">jQuery/jQuery UI: '+a().jquery+"/"+a.ui.version+"</div>");m.push(p);m.push(w[n](h,"http://elfinder.org/")[n](i,k.i18n("homepage")));m.push(w[n](h,"https://github.com/Studio-42/elFinder/wiki")[n](i,k.i18n("docs")));m.push(w[n](h,"https://github.com/Studio-42/elFinder")[n](i,k.i18n("github")));m.push(w[n](h,"http://twitter.com/elrte_elfinder")[n](i,k.i18n("twitter")));m.push(p);m.push('<div class="'+e+'">'+k.i18n("team")+"</div>");m.push(l[n](f,'Dmitry "dio" Levashov &lt;dio@std42.ru&gt;')[n](s,k.i18n("chiefdev")));m.push(l[n](f,"Troex Nevelin &lt;troex@fury.scancode.ru&gt;")[n](s,k.i18n("maintainer")));m.push(l[n](f,"Alexey Sukhotin &lt;strogg@yandex.ru&gt;")[n](s,k.i18n("contributor")));m.push(l[n](f,"Naoki Sawada &lt;hypweb@gmail.com&gt;")[n](s,k.i18n("contributor")));k.i18[k.lang].translator&&m.push(l[n](f,k.i18[k.lang].translator)[n](s,k.i18n("translator")+" ("+k.i18[k.lang].language+")"));m.push(p);m.push('<div class="'+j+'">'+k.i18n("icons")+': Pixelmixer, <a href="http://p.yusukekamiyamane.com" target="_blank">Fugue</a></div>');m.push(p);m.push('<div class="'+j+'">Licence: BSD Licence</div>');m.push('<div class="'+j+'">Copyright © 2009-2011, Studio 42</div>');m.push('<div class="'+j+'">„ …'+k.i18n("dontforget")+" ”</div>");m.push("</div>")},q=function(){var r=k.shortcuts();m.push('<div id="shortcuts" class="ui-tabs-panel ui-widget-content ui-corner-bottom">');if(r.length){m.push('<div class="ui-widget-content elfinder-help-shortcuts">');a.each(r,function(x,y){m.push(c.replace(/\{pattern\}/,y[0]).replace(/\{descrip\}/,y[1]))});m.push("</div>")}else{m.push('<div class="elfinder-help-disabled">'+k.i18n("shortcutsof")+"</div>")}m.push("</div>")},u=function(){m.push('<div id="help" class="ui-tabs-panel ui-widget-content ui-corner-bottom">');m.push('<a href="http://elfinder.org/forum/" target="_blank" class="elfinder-dont-panic"><span>DON\'T PANIC</span></a>');m.push("</div>")},t;this.alwaysEnabled=true;this.updateOnSelect=false;this.state=0;this.shortcuts=[{pattern:"f1",description:this.title}];setTimeout(function(){var x=o.options.view||["about","shortcuts","help"];a.each(x,function(y,z){m.push(b[n](/\{id\}/,z)[n](/\{title\}/,k.i18n(z)))});m.push("</ul>");a.inArray("about",x)!==-1&&g();a.inArray("shortcuts",x)!==-1&&q();a.inArray("help",x)!==-1&&u();m.push("</div>");t=a(m.join(""));k.one("load",function r(){t.find("#apiver").text(k.api)});t.find(".ui-tabs-nav li").hover(function(){a(this).toggleClass("ui-state-hover")}).children().click(function(z){var y=a(this);z.preventDefault();z.stopPropagation();if(!y.is(".ui-tabs-selected")){y.parent().addClass("ui-tabs-selected ui-state-active").siblings().removeClass("ui-tabs-selected").removeClass("ui-state-active");t.find(".ui-tabs-panel").hide().filter(y.attr("href")).show()}}).filter(":first").click()},200);this.getstate=function(){return 0};this.exec=function(){if(!this.dialog){this.dialog=this.fm.dialog(t,{title:this.title,width:530,autoOpen:false,destroyOnClose:false})}this.dialog.elfinderdialog("open").find(".ui-tabs-nav li a:first").click()}};elFinder.prototype.commands.home=function(){this.title="Home";this.alwaysEnabled=true;this.updateOnSelect=false;this.shortcuts=[{pattern:"ctrl+home ctrl+shift+up",description:"Home"}];this.getstate=function(){var b=this.fm.root(),c=this.fm.cwd().hash;return b&&c&&b!=c?0:-1};this.exec=function(){return this.fm.exec("open",this.fm.root())}};"use strict";elFinder.prototype.commands.info=function(){var b="msg",d=this.fm,c="elfinder-info-spinner",e={calc:d.i18n("calc"),size:d.i18n("size"),unknown:d.i18n("unknown"),path:d.i18n("path"),aliasfor:d.i18n("aliasfor"),modify:d.i18n("modify"),perms:d.i18n("perms"),locked:d.i18n("locked"),dim:d.i18n("dim"),kind:d.i18n("kind"),files:d.i18n("files"),folders:d.i18n("folders"),items:d.i18n("items"),yes:d.i18n("yes"),no:d.i18n("no"),link:d.i18n("link")};this.tpl={main:'<div class="ui-helper-clearfix elfinder-info-title"><span class="elfinder-cwd-icon {class} ui-corner-all"/>{title}</div><table class="elfinder-info-tb">{content}</table>',itemTitle:'<strong>{name}</strong><span class="elfinder-info-kind">{kind}</span>',groupTitle:"<strong>{items}: {num}</strong>",row:"<tr><td>{label} : </td><td>{value}</td></tr>",spinner:'<span>{text}</span> <span class="'+c+'"/>'};this.alwaysEnabled=true;this.updateOnSelect=false;this.shortcuts=[{pattern:"ctrl+i"}];this.init=function(){a.each(e,function(g,f){e[g]=d.i18n(f)})};this.getstate=function(){return 0};this.exec=function(f){var q=this,k=this.fm,B=this.tpl,i=B.row,h=this.files(f),w=h.length,u=[],n=B.main,t="{label}",m="{value}",o={title:this.title,width:"auto",close:function(){a(this).elfinderdialog("destroy")}},j=[],y=function(l){x.find("."+c).parent().text(l)},r=k.namespace+"-info-"+a.map(h,function(l){return l.hash}).join("-"),x=k.getUI().find("#"+r),p,g,z,A,s;if(!w){return a.Deferred().reject()}if(x.length){x.elfinderdialog("toTop");return a.Deferred().resolve()}if(w==1){z=h[0];n=n.replace("{class}",k.mime2class(z.mime));A=B.itemTitle.replace("{name}",k.escape(z.i18||z.name)).replace("{kind}",k.mime2kind(z));if(z.tmb){g=k.option("tmbUrl")+z.tmb}if(!z.read){p=e.unknown}else{if(z.mime!="directory"||z.alias){p=k.formatSize(z.size)}else{p=B.spinner.replace("{text}",e.calc);j.push(z.hash)}}u.push(i.replace(t,e.size).replace(m,p));z.alias&&u.push(i.replace(t,e.aliasfor).replace(m,z.alias));u.push(i.replace(t,e.path).replace(m,k.escape(k.path(z.hash,true))));z.read&&u.push(i.replace(t,e.link).replace(m,'<a href="'+k.url(z.hash)+'" target="_blank">'+z.name+"</a>"));if(z.dim){u.push(i.replace(t,e.dim).replace(m,z.dim))}else{if(z.mime.indexOf("image")!==-1){if(z.width&&z.height){u.push(i.replace(t,e.dim).replace(m,z.width+"x"+z.height))}else{u.push(i.replace(t,e.dim).replace(m,B.spinner.replace("{text}",e.calc)));k.request({data:{cmd:"dim",target:z.hash},preventDefault:true}).fail(function(){y(e.unknown)}).done(function(l){y(l.dim||e.unknown)})}}}u.push(i.replace(t,e.modify).replace(m,k.formatDate(z)));u.push(i.replace(t,e.perms).replace(m,k.formatPermissions(z)));u.push(i.replace(t,e.locked).replace(m,z.locked?e.yes:e.no))}else{n=n.replace("{class}","elfinder-cwd-icon-group");A=B.groupTitle.replace("{items}",e.items).replace("{num}",w);s=a.map(h,function(l){return l.mime=="directory"?1:null}).length;if(!s){p=0;a.each(h,function(v,C){var l=parseInt(C.size);if(l>=0&&p>=0){p+=l}else{p="unknown"}});u.push(i.replace(t,e.kind).replace(m,e.files));u.push(i.replace(t,e.size).replace(m,k.formatSize(p)))}else{u.push(i.replace(t,e.kind).replace(m,s==w?e.folders:e.folders+" "+s+", "+e.files+" "+(w-s)));u.push(i.replace(t,e.size).replace(m,B.spinner.replace("{text}",e.calc)));j=a.map(h,function(l){return l.hash})}}n=n.replace("{title}",A).replace("{content}",u.join(""));x=k.dialog(n,o);x.attr("id",r);if(g){a("<img/>").load(function(){x.find(".elfinder-cwd-icon").css("background",'url("'+g+'") center center no-repeat')}).attr("src",g)}if(j.length){k.request({data:{cmd:"size",targets:j},preventDefault:true}).fail(function(){y(e.unknown)}).done(function(v){var l=parseInt(v.size);y(l>=0?k.formatSize(l):e.unknown)})}}};"use strict";elFinder.prototype.commands.mkdir=function(){this.disableOnSearch=true;this.updateOnSelect=false;this.mime="directory";this.prefix="untitled folder";this.exec=a.proxy(this.fm.res("mixin","make"),this);this.shortcuts=[{pattern:"ctrl+shift+n"}];this.getstate=function(){return !this._disabled&&this.fm.cwd().write?0:-1}};"use strict";elFinder.prototype.commands.mkfile=function(){this.disableOnSearch=true;this.updateOnSelect=false;this.mime="text/plain";this.prefix="untitled file.txt";this.exec=a.proxy(this.fm.res("mixin","make"),this);this.getstate=function(){return !this._disabled&&this.fm.cwd().write?0:-1}};"use strict";elFinder.prototype.commands.netmount=function(){var b=this;this.alwaysEnabled=true;this.updateOnSelect=false;this.drivers=[];this.handlers={load:function(){this.drivers=this.fm.netDrivers}};this.getstate=function(){return this.drivers.length?0:-1};this.exec=function(){var e=b.fm,c=a.Deferred(),d=function(){var f={protocol:a("<select/>"),host:a('<input type="text"/>'),port:a('<input type="text"/>'),path:a('<input type="text" value="/"/>'),user:a('<input type="text"/>'),pass:a('<input type="password"/>')},h={title:e.i18n("netMountDialogTitle"),resizable:false,modal:true,destroyOnClose:true,close:function(){delete b.dialog;c.state()=="pending"&&c.reject()},buttons:{}},g=a('<table class="elfinder-info-tb elfinder-netmount-tb"/>');a.each(b.drivers,function(j,k){f.protocol.append('<option value="'+k+'">'+e.i18n(k)+"</option>")});a.each(f,function(j,i){j!="protocol"&&i.addClass("ui-corner-all");g.append(a("<tr/>").append(a("<td>"+e.i18n(j)+"</td>")).append(a("<td/>").append(i)))});h.buttons[e.i18n("btnMount")]=function(){var i={cmd:"netmount"};a.each(f,function(k,j){var l=a.trim(j.val());if(l){i[k]=l}});if(!i.host){return b.fm.trigger("error",{error:"errNetMountHostReq"})}b.fm.request({data:i,notify:{type:"netmount",cnt:1}}).done(function(){c.resolve()}).fail(function(j){c.reject(j)});b.dialog.elfinderdialog("close")};h.buttons[e.i18n("btnCancel")]=function(){b.dialog.elfinderdialog("close")};return e.dialog(g,h)};if(!b.dialog){b.dialog=d()}return c.promise()}};"use strict";elFinder.prototype.commands.open=function(){this.alwaysEnabled=true;this._handlers={dblclick:function(b){b.preventDefault();this.exec()},"select enable disable reload":function(b){this.update(b.type=="disable"?-1:void (0))}};this.shortcuts=[{pattern:"ctrl+down numpad_enter"+(this.fm.OS!="mac"&&" enter")}];this.getstate=function(c){var c=this.files(c),b=c.length;return b==1?0:b?(a.map(c,function(d){return d.mime=="directory"?null:d}).length==b?0:-1):-1};this.exec=function(i){var g=this.fm,d=a.Deferred().fail(function(k){k&&g.error(k)}),b=this.files(i),e=b.length,f,c,j,h;if(!e){return d.reject()}if(e==1&&(f=b[0])&&f.mime=="directory"){return f&&!f.read?d.reject(["errOpen",f.name,"errPerm"]):g.request({data:{cmd:"open",target:f.thash||f.hash},notify:{type:"open",cnt:1,hideCnt:true},syncOnFail:true})}b=a.map(b,function(k){return k.mime!="directory"?k:null});if(e!=b.length){return d.reject()}e=b.length;while(e--){f=b[e];if(!f.read){return d.reject(["errOpen",f.name,"errPerm"])}if(!(c=g.url(f.hash))){c=g.options.url;c=c+(c.indexOf("?")===-1?"?":"&")+(g.oldAPI?"cmd=open&current="+f.phash:"cmd=file")+"&target="+f.hash}if(f.dim){j=f.dim.split("x");h="width="+(parseInt(j[0])+20)+",height="+(parseInt(j[1])+20)}else{h="width="+parseInt(2*a(window).width()/3)+",height="+parseInt(2*a(window).height()/3)}if(!window.open(c,"_blank",h+",top=50,left=50,scrollbars=yes,resizable=yes")){return d.reject("errPopup")}}return d.resolve(i)}};"use strict";elFinder.prototype.commands.paste=function(){this.updateOnSelect=false;this.handlers={changeclipboard:function(){this.update()}};this.shortcuts=[{pattern:"ctrl+v shift+insert"}];this.getstate=function(b){if(this._disabled){return -1}if(b){if(a.isArray(b)){if(b.length!=1){return -1}b=this.fm.file(b[0])}}else{b=this.fm.cwd()}return this.fm.clipboard().length&&b.mime=="directory"&&b.write?0:-1};this.exec=function(j){var o=this,n=o.fm,j=j?this.files(j)[0]:n.cwd(),d=n.clipboard(),g=d.length,m=g?d[0].cut:false,k=m?"errMove":"errCopy",i=[],f=[],c=a.Deferred().fail(function(p){p&&n.error(p)}),b=function(p){return p.length&&n._commands.duplicate?n.exec("duplicate",p):a.Deferred().resolve()},e=function(u){var r=a.Deferred(),q=[],p=function(y,z){var w=[],x=y.length;while(x--){a.inArray(y[x].name,z)!==-1&&w.unshift(x)}return w},s=function(w){var y=q[w],x=u[y],z=w==q.length-1;if(!x){return}n.confirm({title:n.i18n(m?"moveFiles":"copyFiles"),text:n.i18n(["errExists",x.name,"confirmRepl"]),all:!z,accept:{label:"btnYes",callback:function(A){!z&&!A?s(++w):v(u)}},reject:{label:"btnNo",callback:function(B){var A;if(B){A=q.length;while(w<A--){u[q[A]].remove=true}}else{u[q[w]].remove=true}!z&&!B?s(++w):v(u)}},cancel:{label:"btnCancel",callback:function(){r.resolve()}}})},t=function(w){q=p(u,w);q.length?s(0):v(u)},v=function(z){var z=a.map(z,function(B){return !B.remove?B:null}),y=z.length,w={},x=[],A;if(!y){return r.resolve()}A=z[0].phash;z=a.map(z,function(B){return B.hash});n.request({data:{cmd:"paste",dst:j.hash,targets:z,cut:m?1:0,src:A},notify:{type:m?"move":"copy",cnt:y}}).always(function(){r.resolve();n.unlockfiles({files:z})})};if(o._disabled||!u.length){return r.resolve()}if(n.oldAPI){v(u)}else{if(!n.option("copyOverwrite")){v(u)}else{j.hash==n.cwd().hash?t(a.map(n.files(),function(w){return w.phash==j.hash?w.name:null})):n.request({data:{cmd:"ls",target:j.hash},notify:{type:"prepare",cnt:1,hideCnt:true},preventFail:true}).always(function(w){t(w.list||[])})}}return r},l,h;if(!g||!j||j.mime!="directory"){return c.reject()}if(!j.write){return c.reject([k,d[0].name,"errPerm"])}l=n.parents(j.hash);a.each(d,function(q,p){if(!p.read){return !c.reject([k,d[0].name,"errPerm"])}if(m&&p.locked){return !c.reject(["errLocked",p.name])}if(a.inArray(p.hash,l)!==-1){return !c.reject(["errCopyInItself",p.name])}h=n.parents(p.hash);if(a.inArray(j.hash,h)!==-1){if(a.map(h,function(r){var s=n.file(r);return s.phash==j.hash&&s.name==p.name?s:null}).length){return !c.reject(["errReplByChild",p.name])}}if(p.phash==j.hash){f.push(p.hash)}else{i.push({hash:p.hash,phash:p.phash,name:p.name})}});if(c.state()=="rejected"){return c}return a.when(b(f),e(i)).always(function(){m&&n.clipboard([])})}};"use strict";elFinder.prototype.commands.quicklook=function(){var k=this,h=k.fm,c=0,p=1,s=2,e=c,t="elfinder-quicklook-navbar-icon",b="elfinder-quicklook-fullscreen",m=function(w){a(document).trigger(a.Event("keydown",{keyCode:w,ctrlKey:false,shiftKey:false,altKey:false,metaKey:false}))},v=function(w){return{opacity:0,width:20,height:h.view=="list"?1:20,top:w.offset().top+"px",left:w.offset().left+"px"}},g=function(){var w=a(window);return{opacity:1,width:n,height:l,top:parseInt((w.height()-l)/2+w.scrollTop()),left:parseInt((w.width()-n)/2+w.scrollLeft())}},j=function(x){var z=document.createElement(x.substr(0,x.indexOf("/"))),w=false;try{w=z.canPlayType&&z.canPlayType(x)}catch(y){}return w&&w!==""&&w!="no"},n,l,i,d,u=a('<div class="elfinder-quicklook-title"/>'),r=a("<div/>"),q=a('<div class="elfinder-quicklook-info"/>'),f=a('<div class="'+t+" "+t+'-fullscreen"/>').mousedown(function(z){var y=k.window,x=y.is("."+b),w="scroll."+h.namespace,A=a(window);z.stopPropagation();if(x){y.css(y.data("position")).unbind("mousemove");A.unbind(w).trigger(k.resize).unbind(k.resize);o.unbind("mouseenter").unbind("mousemove")}else{y.data("position",{left:y.css("left"),top:y.css("top"),width:y.width(),height:y.height()}).css({width:"100%",height:"100%"});a(window).bind(w,function(){y.css({left:parseInt(a(window).scrollLeft())+"px",top:parseInt(a(window).scrollTop())+"px"})}).bind(k.resize,function(B){k.preview.trigger("changesize")}).trigger(w).trigger(k.resize);y.bind("mousemove",function(B){o.stop(true,true).show().delay(3000).fadeOut("slow")}).mousemove();o.mouseenter(function(){o.stop(true,true).show()}).mousemove(function(B){B.stopPropagation()})}o.attr("style","").draggable(x?"destroy":{});y.toggleClass(b);a(this).toggleClass(t+"-fullscreen-off");a.fn.resizable&&i.add(y).resizable(x?"enable":"disable").removeClass("ui-state-disabled")}),o=a('<div class="elfinder-quicklook-navbar"/>').append(a('<div class="'+t+" "+t+'-prev"/>').mousedown(function(){m(37)})).append(f).append(a('<div class="'+t+" "+t+'-next"/>').mousedown(function(){m(39)})).append('<div class="elfinder-quicklook-navbar-separator"/>').append(a('<div class="'+t+" "+t+'-close"/>').mousedown(function(){k.window.trigger("close")}));this.resize="resize."+h.namespace;this.info=a('<div class="elfinder-quicklook-info-wrapper"/>').append(r).append(q);this.preview=a('<div class="elfinder-quicklook-preview ui-helper-clearfix"/>').bind("change",function(w){k.info.attr("style","").hide();r.removeAttr("class").attr("style","");q.html("")}).bind("update",function(B){var y=k.fm,A=k.preview,x=B.file,w='<div class="elfinder-quicklook-info-data">{value}</div>',z;if(x){!x.read&&B.stopImmediatePropagation();k.window.data("hash",x.hash);k.preview.unbind("changesize").trigger("change").children().remove();u.html(y.escape(x.name));q.html(w.replace(/\{value\}/,x.name)+w.replace(/\{value\}/,y.mime2kind(x))+(x.mime=="directory"?"":w.replace(/\{value\}/,y.formatSize(x.size)))+w.replace(/\{value\}/,y.i18n("modify")+": "+y.formatDate(x)));r.addClass("elfinder-cwd-icon ui-corner-all "+y.mime2class(x.mime));if(x.tmb){a("<img/>").hide().appendTo(k.preview).load(function(){r.css("background",'url("'+z+'") center center no-repeat');a(this).remove()}).attr("src",(z=y.tmb(x.hash)))}k.info.delay(100).fadeIn(10)}else{B.stopImmediatePropagation()}});this.window=a('<div class="ui-helper-reset ui-widget elfinder-quicklook" style="position:absolute"/>').click(function(w){w.stopPropagation()}).append(a('<div class="elfinder-quicklook-titlebar"/>').append(u).append(a('<span class="ui-icon ui-icon-circle-close"/>').mousedown(function(w){w.stopPropagation();k.window.trigger("close")}))).append(this.preview.add(o)).append(k.info.hide()).draggable({handle:"div.elfinder-quicklook-titlebar"}).bind("open",function(z){var y=k.window,w=k.value,x;if(k.closed()&&w&&(x=d.find("#"+w.hash)).length){o.attr("style","");e=p;x.trigger("scrolltoview");y.css(v(x)).show().animate(g(),550,function(){e=s;k.update(1,k.value)})}}).bind("close",function(A){var z=k.window,y=k.preview.trigger("change"),w=k.value,x=d.find("#"+z.data("hash")),B=function(){e=c;z.hide();y.children().remove();k.update(0,k.value)};if(k.opened()){e=p;z.is("."+b)&&f.mousedown();x.length?z.animate(v(x),500,B):B()}});this.alwaysEnabled=true;this.value=null;this.handlers={select:function(){this.update(void (0),this.fm.selectedFiles()[0])},error:function(){k.window.is(":visible")&&k.window.data("hash","").trigger("close")},"searchshow searchhide":function(){this.opened()&&this.window.trigger("close")}};this.shortcuts=[{pattern:"space"}];this.support={audio:{ogg:j('audio/ogg; codecs="vorbis"'),mp3:j("audio/mpeg;"),wav:j('audio/wav; codecs="1"'),m4a:j("audio/x-m4a;")||j("audio/aac;")},video:{ogg:j('video/ogg; codecs="theora"'),webm:j('video/webm; codecs="vp8, vorbis"'),mp4:j('video/mp4; codecs="avc1.42E01E"')||j('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')}};this.closed=function(){return e==c};this.opened=function(){return e==s};this.init=function(){var A=this.options,z=this.window,y=this.preview,w,x;n=A.width>0?parseInt(A.width):450;l=A.height>0?parseInt(A.height):300;h.one("load",function(){i=h.getUI();d=h.getUI("cwd");z.appendTo("body").zIndex(100+i.zIndex());a(document).keydown(function(B){B.keyCode==27&&k.opened()&&z.trigger("close")});if(a.fn.resizable){z.resizable({handles:"se",minWidth:350,minHeight:120,resize:function(){y.trigger("changesize")}})}k.change(function(){if(k.opened()){k.value?y.trigger(a.Event("update",{file:k.value})):z.trigger("close")}});a.each(h.commands.quicklook.plugins||[],function(B,C){if(typeof(C)=="function"){new C(k)}});y.bind("update",function(){k.info.show()})})};this.getstate=function(){return this.fm.selected().length==1?e==s?1:0:-1};this.exec=function(){this.enabled()&&this.window.trigger(this.opened()?"close":"open")};this.hideinfo=function(){this.info.stop(true).hide()}};elFinder.prototype.commands.quicklook.plugins=[function(c){var b=["image/jpeg","image/png","image/gif"],d=c.preview;a.each(navigator.mimeTypes,function(e,g){var f=g.type;if(f.indexOf("image/")===0&&a.inArray(f,b)){b.push(f)}});d.bind("update",function(h){var g=h.file,f;if(a.inArray(g.mime,b)!==-1){h.stopImmediatePropagation();f=a("<img/>").hide().appendTo(d).load(function(){setTimeout(function(){var e=(f.width()/f.height()).toFixed(2);d.bind("changesize",function(){var k=parseInt(d.width()),l=parseInt(d.height()),i,j;if(e<(k/l).toFixed(2)){j=l;i=Math.floor(j*e)}else{i=k;j=Math.floor(i/e)}f.width(i).height(j).css("margin-top",j<l?Math.floor((l-j)/2):0)}).trigger("changesize");c.hideinfo();f.fadeIn(100)},1)}).attr("src",c.fm.url(g.hash))}})},function(d){var b=["text/html","application/xhtml+xml"],e=d.preview,c=d.fm;e.bind("update",function(g){var f=g.file,h;if(a.inArray(f.mime,b)!==-1){g.stopImmediatePropagation();e.one("change",function(){h.state()=="pending"&&h.reject()});h=c.request({data:{cmd:"get",target:f.hash,current:f.phash},preventDefault:true}).done(function(i){d.hideinfo();doc=a('<iframe class="elfinder-quicklook-preview-html"/>').appendTo(e)[0].contentWindow.document;doc.open();doc.write(i.content);doc.close()})}})},function(d){var c=d.fm,b=c.res("mimes","text"),e=d.preview;e.bind("update",function(h){var f=h.file,g=f.mime,i;if(g.indexOf("text/")===0||a.inArray(g,b)!==-1){h.stopImmediatePropagation();e.one("change",function(){i.state()=="pending"&&i.reject()});i=c.request({data:{cmd:"get",target:f.hash},preventDefault:true}).done(function(j){d.hideinfo();a('<div class="elfinder-quicklook-preview-text-wrapper"><pre class="elfinder-quicklook-preview-text">'+c.escape(j.content)+"</pre></div>").appendTo(e)})}})},function(d){var b=d.fm,c="application/pdf",f=d.preview,e=false;if((b.UA.Safari&&b.OS=="mac")||b.UA.IE){e=true}else{a.each(navigator.plugins,function(h,g){a.each(g,function(j,k){if(k.type==c){return !(e=true)}})})}e&&f.bind("update",function(i){var g=i.file,h;if(g.mime==c){i.stopImmediatePropagation();f.one("change",function(){h.unbind("load").remove()});h=a('<iframe class="elfinder-quicklook-preview-pdf"/>').hide().appendTo(f).load(function(){d.hideinfo();h.show()}).attr("src",b.url(g.hash))}})},function(d){var b=d.fm,c="application/x-shockwave-flash",f=d.preview,e=false;a.each(navigator.plugins,function(h,g){a.each(g,function(j,k){if(k.type==c){return !(e=true)}})});e&&f.bind("update",function(i){var g=i.file,h;if(g.mime==c){i.stopImmediatePropagation();d.hideinfo();f.append((h=a('<embed class="elfinder-quicklook-preview-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+b.url(g.hash)+'" quality="high" type="application/x-shockwave-flash" />')))}})},function(e){var f=e.preview,d=!!e.options.autoplay,b={"audio/mpeg":"mp3","audio/mpeg3":"mp3","audio/mp3":"mp3","audio/x-mpeg3":"mp3","audio/x-mp3":"mp3","audio/x-wav":"wav","audio/wav":"wav","audio/x-m4a":"m4a","audio/aac":"m4a","audio/mp4":"m4a","audio/x-mp4":"m4a","audio/ogg":"ogg"},c;f.bind("update",function(i){var g=i.file,h=b[g.mime];if(e.support.audio[h]){i.stopImmediatePropagation();c=a('<audio class="elfinder-quicklook-preview-audio" controls preload="auto" autobuffer><source src="'+e.fm.url(g.hash)+'" /></audio>').appendTo(f);d&&c[0].play()}}).bind("change",function(){if(c&&c.parent().length){c[0].pause();c.remove();c=null}})},function(e){var f=e.preview,d=!!e.options.autoplay,b={"video/mp4":"mp4","video/x-m4v":"mp4","video/ogg":"ogg","application/ogg":"ogg","video/webm":"webm"},c;f.bind("update",function(i){var g=i.file,h=b[g.mime];if(e.support.video[h]){i.stopImmediatePropagation();e.hideinfo();c=a('<video class="elfinder-quicklook-preview-video" controls preload="auto" autobuffer><source src="'+e.fm.url(g.hash)+'" /></video>').appendTo(f);d&&c[0].play()}}).bind("change",function(){if(c&&c.parent().length){c[0].pause();c.remove();c=null}})},function(d){var e=d.preview,b=[],c;a.each(navigator.plugins,function(g,f){a.each(f,function(h,j){(j.type.indexOf("audio/")===0||j.type.indexOf("video/")===0)&&b.push(j.type)})});e.bind("update",function(i){var f=i.file,h=f.mime,g;if(a.inArray(f.mime,b)!==-1){i.stopImmediatePropagation();(g=h.indexOf("video/")===0)&&d.hideinfo();c=a('<embed src="'+d.fm.url(f.hash)+'" type="'+h+'" class="elfinder-quicklook-preview-'+(g?"video":"audio")+'"/>').appendTo(e)}}).bind("change",function(){if(c&&c.parent().length){c.remove();c=null}})}];elFinder.prototype.commands.reload=function(){this.alwaysEnabled=true;this.updateOnSelect=true;this.shortcuts=[{pattern:"ctrl+shift+r f5"}];this.getstate=function(){return 0};this.exec=function(){var c=this.fm,b=c.sync(),d=setTimeout(function(){c.notify({type:"reload",cnt:1,hideCnt:true});b.always(function(){c.notify({type:"reload",cnt:-1})})},c.notifyDelay);return b.always(function(){clearTimeout(d);c.trigger("reload")})}};"use strict";elFinder.prototype.commands.rename=function(){this.shortcuts=[{pattern:"f2"+(this.fm.OS=="mac"?" enter":"")}];this.getstate=function(){var b=this.fm.selectedFiles();return !this._disabled&&b.length==1&&b[0].phash&&!b[0].locked?0:-1};this.exec=function(){var i=this.fm,j=i.getUI("cwd"),e=i.selected(),f=e.length,h=i.file(e.shift()),b=".elfinder-cwd-filename",d=a.Deferred().fail(function(m){var n=k.parent(),l=i.escape(h.name);if(n.length){k.remove();n.html(l)}else{j.find("#"+h.hash).find(b).html(l);setTimeout(function(){j.find("#"+h.hash).click()},50)}m&&i.error(m)}).always(function(){i.enable()}),k=a('<input type="text"/>').keydown(function(l){l.stopPropagation();l.stopImmediatePropagation();if(l.keyCode==a.ui.keyCode.ESCAPE){d.reject()}else{if(l.keyCode==a.ui.keyCode.ENTER){k.blur()}}}).mousedown(function(l){l.stopPropagation()}).dblclick(function(l){l.stopPropagation();l.preventDefault()}).blur(function(){var l=a.trim(k.val()),m=k.parent();if(m.length){if(k[0].setSelectionRange){k[0].setSelectionRange(0,0)}if(l==h.name){return d.reject()}if(!l){return d.reject("errInvName")}if(i.fileByName(l,h.phash)){return d.reject(["errExists",l])}m.html(i.escape(l));i.lockfiles({files:[h.hash]});i.request({data:{cmd:"rename",target:h.hash,name:l},notify:{type:"rename",cnt:1}}).fail(function(n){d.reject();i.sync()}).done(function(n){d.resolve(n)}).always(function(){i.unlockfiles({files:[h.hash]})})}}),g=j.find("#"+h.hash).find(b).empty().append(k.val(h.name)),c=k.val().replace(/\.((tar\.(gz|bz|bz2|z|lzo))|cpio\.gz|ps\.gz|xcf\.(gz|bz2)|[a-z0-9]{1,4})$/ig,"");if(this.disabled()){return d.reject()}if(!h||f>1||!g.length){return d.reject("errCmdParams",this.title)}if(h.locked){return d.reject(["errLocked",h.name])}i.one("select",function(){k.parent().length&&h&&a.inArray(h.hash,i.selected())===-1&&k.blur()});k.select().focus();k[0].setSelectionRange&&k[0].setSelectionRange(0,c.length);return d}};"use strict";elFinder.prototype.commands.resize=function(){this.updateOnSelect=false;this.getstate=function(){var b=this.fm.selectedFiles();return !this._disabled&&b.length==1&&b[0].read&&b[0].write&&b[0].mime.indexOf("image/")!==-1?0:-1};this.exec=function(d){var g=this.fm,f=this.files(d),b=a.Deferred(),c=function(D,S){var ak=a('<div class="elfinder-dialog-resize"/>'),o='<input type="text" size="5"/>',w='<div class="elfinder-resize-row"/>',af='<div class="elfinder-resize-label"/>',H=a('<div class="elfinder-resize-control"/>'),J=a('<div class="elfinder-resize-preview"/>'),M=a('<div class="elfinder-resize-spinner">'+g.i18n("ntfloadimg")+"</div>"),U=a('<div class="elfinder-resize-handle"/>'),Q=a('<div class="elfinder-resize-handle"/>'),ad=a('<div class="elfinder-resize-uiresize"/>'),T=a('<div class="elfinder-resize-uicrop"/>'),s='<div class="ui-widget-content ui-corner-all elfinder-buttonset"/>',ac='<div class="ui-state-default elfinder-button"/>',al='<span class="ui-widget-content elfinder-toolbar-button-separator"/>',z=a('<div class="elfinder-resize-rotate"/>'),E=a(ac).attr("title",g.i18n("rotate-cw")).append(a('<span class="elfinder-button-icon elfinder-button-icon-rotate-l"/>').click(function(){u=u-90;an.update(u)})),K=a(ac).attr("title",g.i18n("rotate-ccw")).append(a('<span class="elfinder-button-icon elfinder-button-icon-rotate-r"/>').click(function(){u=u+90;an.update(u)})),k=a("<span />"),ab=a('<div class="ui-state-default ui-corner-all elfinder-resize-reset"><span class="ui-icon ui-icon-arrowreturnthick-1-w"/></div>'),N=a('<div class="elfinder-resize-type"/>').append('<input type="radio" name="type" id="type-resize" value="resize" checked="checked" /><label for="type-resize">'+g.i18n("resize")+"</label>").append('<input type="radio" name="type" id="type-crop"   value="crop"/><label for="type-crop">'+g.i18n("crop")+"</label>").append('<input type="radio" name="type" id="type-rotate" value="rotate"/><label for="type-rotate">'+g.i18n("rotate")+"</label>"),ap=a("input",N).change(function(){var aq=a("input:checked",N).val();p();W(true);V(true);O(true);if(aq=="resize"){ad.show();z.hide();T.hide();W()}else{if(aq=="crop"){z.hide();ad.hide();T.show();V()}else{if(aq=="rotate"){ad.hide();T.hide();z.show();O()}}}}),I=a('<input type="checkbox" checked="checked"/>').change(function(){aj=!!I.prop("checked");A.fixHeight();W(true);W()}),i=a(o).change(function(){var aq=parseInt(i.val()),ar=parseInt(aj?aq/aa:n.val());if(aq>0&&ar>0){A.updateView(aq,ar);n.val(ar)}}),n=a(o).change(function(){var ar=parseInt(n.val()),aq=parseInt(aj?ar*aa:i.val());if(aq>0&&ar>0){A.updateView(aq,ar);i.val(aq)}}),j=a(o),ao=a(o),Y=a(o),X=a(o),l=a('<input type="text" size="3" maxlength="3" value="0" />').change(function(){an.update()}),ah=a('<div class="elfinder-resize-rotate-slider"/>').slider({min:0,max:359,value:l.val(),animate:true,change:function(aq,ar){if(ar.value!=ah.slider("value")){an.update(ar.value)}},slide:function(aq,ar){an.update(ar.value,false)}}),aa=1,B=1,t=0,y=0,aj=true,ae=0,v=0,ai=0,x=0,u=0,q=a("<img/>").load(function(){M.remove();t=q.width();y=q.height();aa=t/y;A.updateView(t,y);U.append(q.show()).show();i.val(t);n.val(y);var aq=Math.min(ae,v)/Math.sqrt(Math.pow(t,2)+Math.pow(y,2));ai=t*aq;x=y*aq;H.find("input,select").removeAttr("disabled").filter(":text").keydown(function(at){var au=at.keyCode,ar;at.stopPropagation();if((au>=37&&au<=40)||au==a.ui.keyCode.BACKSPACE||au==a.ui.keyCode.DELETE||(au==65&&(at.ctrlKey||at.metaKey))||au==27){return}if(au==9){ar=a(this).parent()[at.shiftKey?"prev":"next"](".elfinder-resize-row").children(":text");if(ar.length){ar.focus()}}if(au==13){C();return}if(!((au>=48&&au<=57)||(au>=96&&au<=105))){at.preventDefault()}}).filter(":first").focus();W();ab.hover(function(){ab.toggleClass("ui-state-hover")}).click(p)}).error(function(){M.text("Unable to load image").css("background","transparent")}),R=a("<div/>"),ag=a("<img/>"),r=a("<div/>"),P=a("<img/>"),p=function(){i.val(t);n.val(y);A.updateView(t,y)},A={update:function(){i.val(parseInt(q.width()/B));n.val(parseInt(q.height()/B))},updateView:function(aq,ar){if(aq>ae||ar>v){if(aq/ae>ar/v){q.width(ae).height(Math.ceil(q.width()/aa))}else{q.height(v).width(Math.ceil(q.height()*aa))}}else{q.width(aq).height(ar)}B=q.width()/aq;k.text("1 : "+(1/B).toFixed(2));A.updateHandle()},updateHandle:function(){U.width(q.width()).height(q.height())},fixWidth:function(){var aq,ar;if(aj){ar=n.val();ar=parseInt(ar*aa);A.updateView(aq,ar);i.val(aq)}},fixHeight:function(){var aq,ar;if(aj){aq=i.val();ar=parseInt(aq/aa);A.updateView(aq,ar);n.val(ar)}}},m={update:function(){Y.val(parseInt(Q.width()/B));X.val(parseInt(Q.height()/B));j.val(parseInt((Q.offset().left-ag.offset().left)/B));ao.val(parseInt((Q.offset().top-ag.offset().top)/B))},resize_update:function(){m.update();r.width(Q.width());r.height(Q.height())}},an={mouseStartAngle:0,imageStartAngle:0,imageBeingRotated:false,update:function(ar,aq){if(typeof ar=="undefined"){u=ar=parseInt(l.val())}if(typeof aq=="undefined"){aq=true}if(!aq||g.UA.Opera||g.UA.ltIE8){P.rotate(ar)}else{P.animate({rotate:ar+"deg"})}ar=ar%360;if(ar<0){ar+=360}l.val(parseInt(ar));ah.slider("value",l.val())},execute:function(av){if(!an.imageBeingRotated){return}var au=an.getCenter(P);var at=av.pageX-au[0];var aw=av.pageY-au[1];var aq=Math.atan2(aw,at);var ar=aq-an.mouseStartAngle+an.imageStartAngle;ar=Math.round(parseFloat(ar)*180/Math.PI);if(av.shiftKey){ar=Math.round((ar+6)/15)*15}P.rotate(ar);ar=ar%360;if(ar<0){ar+=360}l.val(ar);ah.slider("value",l.val());return false},start:function(at){an.imageBeingRotated=true;var ar=an.getCenter(P);var au=at.pageX-ar[0];var aq=at.pageY-ar[1];an.mouseStartAngle=Math.atan2(aq,au);an.imageStartAngle=parseFloat(P.rotate())*Math.PI/180;a(document).mousemove(an.execute);return false},stop:function(aq){if(!an.imageBeingRotated){return}a(document).unbind("mousemove",an.execute);setTimeout(function(){an.imageBeingRotated=false},10);return false},getCenter:function(at){var ar=P.rotate();P.rotate(0);var au=P.offset();var aq=au.left+P.width()/2;var av=au.top+P.height()/2;P.rotate(ar);return Array(aq,av)}},W=function(aq){if(a.fn.resizable){if(aq){U.filter(":ui-resizable").resizable("destroy");U.hide()}else{U.show();U.resizable({alsoResize:q,aspectRatio:aj,resize:A.update,stop:A.fixHeight})}}},V=function(aq){if(a.fn.draggable&&a.fn.resizable){if(aq){Q.filter(":ui-resizable").resizable("destroy");Q.filter(":ui-draggable").draggable("destroy");R.hide()}else{ag.width(q.width()).height(q.height());r.width(q.width()).height(q.height());Q.width(ag.width()).height(ag.height()).offset(ag.offset()).resizable({containment:R,resize:m.resize_update,handles:"all"}).draggable({handle:Q,containment:ag,drag:m.update});R.show().width(q.width()).height(q.height());m.update()}}},O=function(aq){if(a.fn.draggable&&a.fn.resizable){if(aq){P.hide()}else{P.show().width(ai).height(x).css("margin-top",(v-x)/2+"px").css("margin-left",(ae-ai)/2+"px")}}},C=function(){var ar,at,aq,aw,av;var au=a("input:checked",N).val();i.add(n).change();if(au=="resize"){ar=parseInt(i.val())||0;at=parseInt(n.val())||0}else{if(au=="crop"){ar=parseInt(Y.val())||0;at=parseInt(X.val())||0;aq=parseInt(j.val())||0;aw=parseInt(ao.val())||0}else{if(au="rotate"){ar=t;at=y;av=parseInt(l.val())||0;if(av<0||av>360){return g.error("Invalid rotate degree")}if(av==0||av==360){return g.error("Image dose not rotated")}}}}if(au!="rotate"){if(ar<=0||at<=0){return g.error("Invalid image size")}if(ar==t&&at==y){return g.error("Image size not changed")}}ak.elfinderdialog("close");g.request({data:{cmd:"resize",target:D.hash,width:ar,height:at,x:aq,y:aw,degree:av,mode:au},notify:{type:"resize",cnt:1}}).fail(function(ax){b.reject(ax)}).done(function(){b.resolve()})},L={},Z="elfinder-resize-handle-hline",am="elfinder-resize-handle-vline",G="elfinder-resize-handle-point",F=g.url(D.hash);P.mousedown(an.start);a(document).mouseup(an.stop);ad.append(a(w).append(a(af).text(g.i18n("width"))).append(i).append(ab)).append(a(w).append(a(af).text(g.i18n("height"))).append(n)).append(a(w).append(a("<label/>").text(g.i18n("aspectRatio")).prepend(I))).append(a(w).append(g.i18n("scale")+" ").append(k));T.append(a(w).append(a(af).text("X")).append(j)).append(a(w).append(a(af).text("Y")).append(ao)).append(a(w).append(a(af).text(g.i18n("width"))).append(Y)).append(a(w).append(a(af).text(g.i18n("height"))).append(X));z.append(a(w).append(a(af).text(g.i18n("rotate"))).append(a('<div style="float:left; width: 130px;">').append(a('<div style="float:left;">').append(l).append(a("<span/>").text(g.i18n("degree")))).append(a(s).append(E).append(a(al)).append(K))).append(ah));ak.append(N);H.append(a(w)).append(ad).append(T.hide()).append(z.hide()).find("input,select").attr("disabled","disabled");U.append('<div class="'+Z+" "+Z+'-top"/>').append('<div class="'+Z+" "+Z+'-bottom"/>').append('<div class="'+am+" "+am+'-left"/>').append('<div class="'+am+" "+am+'-right"/>').append('<div class="'+G+" "+G+'-e"/>').append('<div class="'+G+" "+G+'-se"/>').append('<div class="'+G+" "+G+'-s"/>');J.append(M).append(U.hide()).append(q.hide());Q.css("position","absolute").append('<div class="'+Z+" "+Z+'-top"/>').append('<div class="'+Z+" "+Z+'-bottom"/>').append('<div class="'+am+" "+am+'-left"/>').append('<div class="'+am+" "+am+'-right"/>').append('<div class="'+G+" "+G+'-n"/>').append('<div class="'+G+" "+G+'-e"/>').append('<div class="'+G+" "+G+'-s"/>').append('<div class="'+G+" "+G+'-w"/>').append('<div class="'+G+" "+G+'-ne"/>').append('<div class="'+G+" "+G+'-se"/>').append('<div class="'+G+" "+G+'-sw"/>').append('<div class="'+G+" "+G+'-nw"/>');J.append(R.css("position","absolute").hide().append(ag).append(Q.append(r)));J.append(P.hide());J.css("overflow","hidden");ak.append(J).append(H);L[g.i18n("btnCancel")]=function(){ak.elfinderdialog("close")};L[g.i18n("btnApply")]=C;g.dialog(ak,{title:D.name,width:650,resizable:false,destroyOnClose:true,buttons:L,open:function(){J.zIndex(1+a(this).parent().zIndex())}}).attr("id",S);if(g.UA.ltIE8){a(".elfinder-dialog").css("filter","")}ab.css("left",i.position().left+i.width()+12);r.css({opacity:0.2,"background-color":"#fff",position:"absolute"}),Q.css("cursor","move");Q.find(".elfinder-resize-handle-point").css({"background-color":"#fff",opacity:0.5,"border-color":"#000"});P.css("cursor","pointer");N.buttonset();ae=J.width()-(U.outerWidth()-U.width());v=J.height()-(U.outerHeight()-U.height());q.attr("src",F+(F.indexOf("?")===-1?"?":"&")+"_="+Math.random());ag.attr("src",q.attr("src"));P.attr("src",q.attr("src"))},h,e;if(!f.length||f[0].mime.indexOf("image/")===-1){return b.reject()}h="resize-"+g.namespace+"-"+f[0].hash;e=g.getUI().find("#"+h);if(e.length){e.elfinderdialog("toTop");return b.resolve()}c(f[0],h);return b}};"use strict";elFinder.prototype.commands.rm=function(){this.shortcuts=[{pattern:"delete ctrl+backspace"}];this.getstate=function(c){var b=this.fm;c=c||b.selected();return !this._disabled&&c.length&&a.map(c,function(d){var e=b.file(d);return e&&e.phash&&!e.locked?d:null}).length==c.length?0:-1};this.exec=function(d){var c=this,i=this.fm,b=a.Deferred().fail(function(j){j&&i.error(j)}),h=this.files(d),e=h.length,g=i.cwd().hash,f=false;if(!e||this._disabled){return b.reject()}a.each(h,function(k,j){if(!j.phash){return !b.reject(["errRm",j.name,"errPerm"])}if(j.locked){return !b.reject(["errLocked",j.name])}if(j.hash==g){f=i.root(j.hash)}});if(b.state()=="pending"){h=this.hashes(d);i.confirm({title:c.title,text:"confirmRm",accept:{label:"btnRm",callback:function(){i.lockfiles({files:h});i.request({data:{cmd:"rm",targets:h},notify:{type:"rm",cnt:e},preventFail:true}).fail(function(j){b.reject(j)}).done(function(j){b.done(j);f&&i.exec("open",f)}).always(function(){i.unlockfiles({files:h})})}},cancel:{label:"btnCancel",callback:function(){b.reject()}}})}return b}};"use strict";elFinder.prototype.commands.search=function(){this.title="Find files";this.options={ui:"searchbutton"};this.alwaysEnabled=true;this.updateOnSelect=false;this.getstate=function(){return 0};this.exec=function(c){var b=this.fm;if(typeof(c)=="string"&&c){b.trigger("searchstart",{query:c});return b.request({data:{cmd:"search",q:c},notify:{type:"search",cnt:1,hideCnt:true}})}b.getUI("toolbar").find("."+b.res("class","searchbtn")+" :text").focus();return a.Deferred().reject()}};"use strict";elFinder.prototype.commands.sort=function(){this.options={ui:"sortbutton"};this.getstate=function(){return 0};this.exec=function(b,c){var d=this.fm,c=a.extend({type:d.sortType,order:d.sortOrder,stick:d.sortStickFolders},c);this.fm.setSort(c.type,c.order,c.stick);return a.Deferred().resolve()}};"use strict";elFinder.prototype.commands.up=function(){this.alwaysEnabled=true;this.updateOnSelect=false;this.shortcuts=[{pattern:"ctrl+up"}];this.getstate=function(){return this.fm.cwd().phash?0:-1};this.exec=function(){return this.fm.cwd().phash?this.fm.exec("open",this.fm.cwd().phash):a.Deferred().reject()}};"use strict";elFinder.prototype.commands.upload=function(){var b=this.fm.res("class","hover");this.disableOnSearch=true;this.updateOnSelect=false;this.shortcuts=[{pattern:"ctrl+u"}];this.getstate=function(){return !this._disabled&&this.fm.cwd().write?0:-1};this.exec=function(j){var i=this.fm,f=function(k){h.elfinderdialog("close");i.upload(k).fail(function(l){e.reject(l)}).done(function(l){e.resolve(l)})},e,h,d,g,c;if(this.disabled()){return a.Deferred().reject()}if(j&&(j.input||j.files)){return i.upload(j)}e=a.Deferred();d=a('<input type="file" multiple="true"/>').change(function(){f({input:d[0]})});g=a('<div class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"><span class="ui-button-text">'+i.i18n("selectForUpload")+"</span></div>").append(a("<form/>").append(d)).hover(function(){g.toggleClass(b)});h=a('<div class="elfinder-upload-dialog-wrapper"/>').append(g);if(i.dragUpload){c=a('<div class="ui-corner-all elfinder-upload-dropbox">'+i.i18n("dropFiles")+"</div>").prependTo(h).after('<div class="elfinder-upload-dialog-or">'+i.i18n("or")+"</div>")[0];c.addEventListener("dragenter",function(k){k.stopPropagation();k.preventDefault();a(c).addClass(b)},false);c.addEventListener("dragleave",function(k){k.stopPropagation();k.preventDefault();a(c).removeClass(b)},false);c.addEventListener("dragover",function(k){k.stopPropagation();k.preventDefault()},false);c.addEventListener("drop",function(k){k.stopPropagation();k.preventDefault();f({files:k.dataTransfer.files})},false)}i.dialog(h,{title:this.title,modal:true,resizable:false,destroyOnClose:true});return e}};"use strict";elFinder.prototype.commands.view=function(){this.value=this.fm.viewType;this.alwaysEnabled=true;this.updateOnSelect=false;this.options={ui:"viewbutton"};this.getstate=function(){return 0};this.exec=function(){var b=this.fm.storage("view",this.value=="list"?"icons":"list");this.fm.viewchange();this.update(void (0),b)}}})(jQuery);(function(f){var e=function(g,j){var h=0;for(h in j){if(typeof g[j[h]]!="undefined"){return j[h]}}g[j[h]]="";return j[h]};f.cssHooks.rotate={get:function(i,h,g){return f(i).rotate()},set:function(g,h){f(g).rotate(h);return h}};f.cssHooks.transform={get:function(j,i,g){var h=e(j.style,["WebkitTransform","MozTransform","OTransform","msTransform","transform"]);return j.style[h]},set:function(h,i){var g=e(h.style,["WebkitTransform","MozTransform","OTransform","msTransform","transform"]);h.style[g]=i;return i}};f.fn.rotate=function(h){if(typeof h=="undefined"){if(!!window.opera){var g=this.css("transform").match(/rotate\((.*?)\)/);return(g&&g[1])?Math.round(parseFloat(g[1])*180/Math.PI):0}else{var g=this.css("transform").match(/rotate\((.*?)\)/);return(g&&g[1])?parseInt(g[1]):0}}this.css("transform",this.css("transform").replace(/none|rotate\(.*?\)/,"")+"rotate("+parseInt(h)+"deg)");return this};f.fx.step.rotate=function(g){if(g.state==0){g.start=f(g.elem).rotate();g.now=g.start}f(g.elem).rotate(g.now)};if(typeof window.addEventListener=="undefined"&&typeof document.getElementsByClassName=="undefined"){var a=function(h){var i=h;var g=i.offsetLeft;var j=i.offsetTop;while(i.offsetParent){i=i.offsetParent;if(i!=document.body&&i.currentStyle.position!="static"){break}if(i!=document.body&&i!=document.documentElement){g-=i.scrollLeft;j-=i.scrollTop}g+=i.offsetLeft;j+=i.offsetTop}return{x:g,y:j}};var c=function(g){if(g.currentStyle.position!="static"){return}var h=a(g);g.style.position="absolute";g.style.left=h.x+"px";g.style.top=h.y+"px"};var d=function(m,k){var g;var q=1;var o=1;var i=1;var h=1;if(typeof m.style.msTransform!="undefined"){return true}c(m);g=k.match(/rotate\((.*?)\)/);var l=(g&&g[1])?parseInt(g[1]):0;l=l%360;if(l<0){l=360+l}var u=l*Math.PI/180;var n=Math.cos(u);var s=Math.sin(u);q*=n;o*=-s;i*=s;h*=n;m.style.filter=(m.style.filter||"").replace(/progid:DXImageTransform\.Microsoft\.Matrix\([^)]*\)/,"")+("progid:DXImageTransform.Microsoft.Matrix(M11="+q+",M12="+o+",M21="+i+",M22="+h+",FilterType='bilinear',sizingMethod='auto expand')");var j=parseInt(m.style.width||m.width||0);var v=parseInt(m.style.height||m.height||0);var u=l*Math.PI/180;var p=Math.abs(Math.cos(u));var t=Math.abs(Math.sin(u));var x=(j-(j*p+v*t))/2;var w=(v-(j*t+v*p))/2;m.style.marginLeft=Math.floor(x)+"px";m.style.marginTop=Math.floor(w)+"px";return(true)};var b=f.cssHooks.transform.set;f.cssHooks.transform.set=function(g,h){b.apply(this,[g,h]);d(g,h);return h}}})(jQuery);
